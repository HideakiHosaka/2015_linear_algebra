\chapter{種々の函数}

\begin{flushright}
担当教員: 植野 義明 / TA: 穂坂 秀昭 \\
講義日時: 2015年4月22日 1限
\end{flushright}

\section{逆函数について}

\section{逆三角函数}

\paragraph{問2, 3} $\tan$の加法定理
\[
\tan(x+y) = \frac{\tan x + \tan y}{1 - \tan x\tan y}
\]
に$u=\tan x$, $v=\tan y$を代入すると
\begin{align*}
\arctan u + \arctan y
&= x + y = \arctan \tan(x+y)
= \arctan \frac{\tan x + \tan y}{1 - \tan x\tan y}
= \arctan \Bigl(\frac{u+v}{1-uv}\Bigr)
\end{align*}
を得る。この式で$u=1/2$, $v=1/3$とおくと、右辺は
\[
\arctan \Bigl(\frac{u+v}{1-uv}\Bigr) = \arctan \Bigl(\frac{1/2+1/3}{1-1/6}\Bigr) = \arctan 1 = \frac{\pi}{4}
\]
なので
\[
\frac{\pi}{4} = \arctan \frac{1}{2} + \arctan \frac{1}{3}
\]
が得られる。これはEulerの公式と呼ばれる

また$u=v=1/5$とおくと、同じように計算することで
\[
2\arctan\frac{1}{5} = \arctan\frac{2/5}{1-(1/25)} = \arctan\frac{5}{12}
\]
となる。さらに$u=v=5/12$に対しては
\[
2\arctan\frac{5}{12} = \arctan\frac{10/12}{1-(25/144)} = \arctan\frac{120}{119}
\]
である。そして$u=120/119$に対し$(u+v)/(1-uv)=1$となる$v$を求めると、$v=(1-u)/(1+u)=-1/239$となる。これらをまとめると
\begin{align*}
\frac{\pi}{4}
&= \arctan \frac{\frac{120}{119}+\frac{-1}{239}}{1-\frac{120}{119}\frac{-1}{239}}
= \arctan \frac{120}{119} + \arctan\frac{-1}{239}
= 2\arctan\frac{5}{12} - \arctan\frac{1}{239}
= 4\arctan\frac{1}{5} - \arctan\frac{1}{239}
\end{align*}

\paragraph{問4}
\begin{enumerate}
\item[(1)] $(3+i)(7+i) = 20+10i$
\item[(2)] $(2+i)(3+i) = 5+5i$
\item[(3)] $(5+i)^4/(239+i) = 2+2i$
\end{enumerate}
\[
\arctan\frac{1}{3} + \arctan\frac{1}{7} = \arctan\frac{1}{2},
\arctan\frac{1}{2} + \arctan\frac{1}{3} = \arctan{1} = \frac{\pi}{4},
4\arctan\frac{1}{5} - \arctan\frac{1}{239} = \arctan{1} = \frac{\pi}{4}
\]

\paragraph{問5} 45度

\paragraph{円周率の計算}

$\arctan$には次のような公式があります:
\[
\arctan x = x - \frac{x^3}{3} + \frac{x^5}{5} - \frac{x^7}{7} + \cdots
\]
この公式は、形式的には
\[
\arctan x = \int_0^x (\arctan t)' dt = \int_0^x \frac{1}{1+t^2} dt = \int_0^x (1-t^2+t^4-t^6+\cdots) dt
= x - \frac{x^3}{3} + \frac{x^5}{5} - \frac{x^7}{7} + \cdots
\]
のようにして求められます\footnote{この証明は全然厳密ではありません。まず、何も考えずに無限和と積分の順序を入れ替えてはいけません。また$1/(1+t^2)$の展開ができるのは$t^2<1$の範囲だけです。}。右辺は頑張ればいくらでも精度よく計算できますから、この公式をガリガリ計算することで$\arctan x$の値を求めることができます。たとえば$x=1$とすれば
\[
\frac{\pi}{4} = \arctan 1 = 1 - \frac{1}{3} + \frac{1}{5} - \frac{1}{7} + \cdots
\]
という風にして円周率が求められます。これはLeibnizの公式と呼ばれているようです。

ただし、今の$\pi/4$公式は非常に効率が悪いです。というのも第$50$番目の項が$-1/99 = 0.010101\cdots$ですから、$50$番目の項を計算すると小数第$2$位の値が変わります。円周率を求める上では「ちょこっと計算しただけで、上の方の桁が正確に分かる」ような公式が望ましいわけで、こんな「$50$項も計算してもまだ小数第$2$位が分からない」なんて公式は役に立ちません。そこで登場するのがEulerの公式やMachinの公式です。たとえばEulerの公式なら
\begin{align*}
\frac{\pi}{4}
&= \arctan \frac{1}{2} + \arctan \frac{1}{3}
= \Bigl(\frac{1}{2} - \frac{1}{3\cdot 2^3} + \frac{1}{5\cdot 2^5} - \cdots\Bigr)
+ \Bigl(\frac{1}{3} - \frac{1}{3\cdot 3^3} + \frac{1}{5\cdot 3^5} - \cdots\Bigr) \\
&= \Bigl(\frac{1}{2} - \frac{1}{24} + \frac{1}{160} - \cdots\Bigr)
+ \Bigl(\frac{1}{3} - \frac{1}{81} + \frac{1}{1215} - \cdots\Bigr)
\end{align*}
のように、分母にある$x^n$の項が効いてきて、足し引きされる項の値が急激に小さくなっていきます。今の場合、最初から$3$つずつの項を拾うだけで$\pi=3.14\cdots$が求まります。さっきより断然楽ですね。Machinの公式に至っては$1/239$という項がありますから、少ない手間でもっと精度よい値を求められます。William Jonesという数学者が1706年に著した``Synopsis Palmariorum Mathesos''という本\footnote{ちなみに本郷キャンパスにある総合図書館の書庫内に、この本があるそうです。OPACで検索すると出てきます。}に、Machinが求めたとされる円周率が100桁以上載っていますが、今の公式を使ったのでしょうか？

もちろん$x$に放り込む数が小さくなれば小さくなるほど、計算はどんどん楽になります。したがって「$\pi$が上手く出てくる$\arctan$の公式を見つけて、君だけのオリジナルの円周率近似公式をつくろう！」…という話になりそうですが、実はこの公式は頑張ってもそんなに精度が出ません。いまの公式では分母に$x^n$が出てくることがキモだったので「$1$つ先の項を計算したときに、何桁分だけ精度が良くなるか」は毎回同じです。もし$x$が$100$だったら、次の項を考えてもせいぜい$2$桁程度しか制度が良くならないわけです。ところが世の中には「$n$回目の計算で、それまでの桁数の倍の桁数だけ精度が良くなる」という、圧倒的に強い公式があります。Gauss--Legendreの公式といいますので、興味のある人は調べてみてください。

\section{双曲線函数と逆双曲線函数}


\paragraph{問6}
(a) 点$(u_0,v_0)$を双曲線$u^2-v^2=1$上の、$u_0,v_0>0$を満たす点とする。このとき$\sinh\colon\mathbb{R}\rightarrow\mathbb{R}$は全単射だから、$v_0=\sinh t_0$となる$t_0$がただ一つ存在する。このとき$u_0^2=1+v_0^2=\cosh^2 t_0$となるので、$u_0>0$と合わせて$u_0=\cosh t_0$を得る。そして$u$軸、双曲線と直線$\mathrm{OP}$とで囲まれる部分の面積は
\begin{align*}
\int_0^{u_0} \frac{v_0}{u_0}u du - \int_1^{u_0} \sqrt{u^2-1} du
&= \frac{u_0v_0}{2} - \int_0^{t_0} \sqrt{\cosh^2 t -1} \sinh t \,dt 
= \frac{u_0v_0}{2} - \int_0^{t_0} \sinh^2 t \,dt  \\
&= \frac{u_0v_0}{2} - \int_0^{t_0} \frac{\cosh 2t - 1}{2} \,dt
= \frac{u_0v_0}{2} + \frac{t_0}{2} - \frac{\sinh 2t_0}{4} \\
&= \frac{\cosh t_0 \sinh t_0}{2} + \frac{t_0}{2} - \frac{\sinh t_0 \cosh t_0}{2} = \frac{t_0}{2}
\end{align*}
となる。

(b)
\begin{align*}
\cosh x \cosh y + \sinh x \sinh y
&= \frac{e^x + e^{-x}}{2} \frac{e^y + e^{-y}}{2} + \frac{e^x - e^{-x}}{2}\frac{e^y - e^{-y}}{2} \\
&= \frac{e^{x+y} + e^{x-y} + e^{-x+y} + e^{-(x+y)}}{4} + \frac{e^{x+y} - e^{x-y} - e^{-x+y} + e^{-(x+y)}}{4} \\
&= \cosh(x+y) \\
\sinh x \cosh y + \cosh x \sinh y
&= \frac{e^x - e^{-x}}{2} \frac{e^y + e^{-y}}{2} + \frac{e^x + e^{-x}}{2}\frac{e^y - e^{-y}}{2} \\
&= \frac{e^{x+y} + e^{x-y} - e^{-x+y} - e^{-(x+y)}}{4} + \frac{e^{x+y} + e^{x-y} - e^{-x+y} - e^{-(x+y)}}{4} \\
&= \sinh(x+y)
\end{align*}

\noindent (c) 
$y=\cosh x = (e^x+e^{-x})/2$とおくと、$(e^x)^2 + 1 = 2ye^x$である。よって$e^x$の$2$次方程式$(e^x)^2 - 2y e^x+1=0$を解いて
$e^x = y\pm\sqrt{y^2-1}$を得る。よって$\arccosh y = x = \log(y\pm\sqrt{y^2-1})$である。$\pm$の符号は上の枝と下の枝

同様に$y=\sinh x = (e^x - e^{-x})/2$を$e^x$について解くと$e^x=y\pm\sqrt{y^2+1}$を得る。ただし$e^x>0$なので$-$の符号は不適である。よって$x=\arcsinh x=\log(y+\sqrt{y^2+1})$が得られる。

\noindent (d)
\begin{align*}
(\cosh x)' &= \sinh x & 
(\arccosh x)' &= \frac{1+\frac{2x}{2\sqrt{x^2-1}}}{x+\sqrt{x^2-1}} = \frac{1}{\sqrt{x^2-1}} \\
(\sinh x)' &= \cosh x &
(\arcsinh x)' &= \frac{1+\frac{2x}{2\sqrt{x^2+1}}}{x+\sqrt{x^2+1}} = \frac{1}{\sqrt{x^2+1}}
\end{align*}
