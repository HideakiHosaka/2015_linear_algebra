\chapter{掃き出し法}

\lectureinfo{2015年6月24日 1限}

\section{過去のプリントについて}

前回何人かの人から「過去のプリントはどこか」と尋ねられました。過去のプリントは\uline{全て$1$つのファイルにまとめて}
\begin{center}
\url{https://github.com/HideakiHosaka/2015_linear_algebra/raw/master/2015linear_algebra.pdf}
\end{center}
に置いてあります。授業を休むなどしてしまった人は、ここからダウンロードしてください。ただファイルサイズが30MBほどあるので、容量には気を付けてください。

ちなみに過去に配ったプリントに間違いがあった場合は、オンラインの方を随時修正しています。ですから配られたプリントを読んで「なんかおかしいぞ？」と思ったときは、オンラインで修正されていないか適宜確認してください。そして、オンラインでも修正されていない間違いを見つけたときは、指摘していただけると助かります。ご協力よろしくお願いします。

\section{問題の答えと計算のコツ}

\subsection{解答一覧}

最初に答えの一覧をまとめておきます。計算方法さえ分かってしまえば解ける問題ですし、掃き出しの順序は色々あり得るので、解くステップは一々載せません。後で掃き出し法に関連する色々なことを説明する際に、一部の問題を詳しい手順付きで解いてみせます。

なお解が複数ある場合、解の表示を$1$つだけ紹介しています。ここに書かれていない表記法が間違いだというわけではありません。

\paragraph{問1} すべて$(x, y) = (-1, -2)$

\paragraph{問2}
(1) $(x, y) = (0, 4/3)$ \quad (2) $(x, y) = (3, 2)$ \quad (3) $(x, y) = (1, -1)$ \quad (4) $(x, y) = (-3, 4)$

\paragraph{問3}
(1) $(x, y, z) = (2, -3, -1)$ \quad (2) $(x, y, z) = (-10, 1, 1)$ \quad (3) $(x, y, z) = (0, 1, -2)$ 

\paragraph{問4}
(1) $(x, y, z) = (1, 1, -1)$ \quad (2) $(x, y, z) = (2, 3, -1)$ \quad (3) $(x, y, z) = (-11, 0, 1)$

\paragraph{問5}
(1) $z$は任意で$(x, y) = (z - 1, -8z + 2)$ \quad (2) 解なし \quad (3) $z$は任意で$(x, y) = \bigl((5z - 6)/7, (11z - 2)/7 \bigr)$

\paragraph{問6}
(1) $(x, y, z) = (0, 0, 0)$ \quad (2) $z, w$は任意で$(x, y) = \bigl((3z - 7w)/ 5, (11z - 4w)/5 \bigr)$

\paragraph{問7} タコとイカの数をそれぞれ$x, y$とおく。タコは$8$本足、イカは$10$本足の生き物\footnote{僕たちがイカの「足」だと思っているものは本当は「腕」らしいのですが、そこは見なかったことにします。また生きているイカは$8$本しか足がないように見えますが、残り$2$本は体の中に収まっているんだそうです。「マリンワールド 海の中道」という水族館のページに情報がありました: \url{http://www.marine-world.co.jp/er/topics/2010_03.html}}なので、
\begin{align*}
\begin{cases}
x + y &= 8 \\
8x + 10y &= 70
\end{cases}
\end{align*}
という方程式が立つ。これを解いて$x = 5$, $y = 3$を得る。

\paragraph{問8} 狐狸と鵬鳥の数をそれぞれ$x, y$とおく\footnote{この問題の出典となった程大位『算法統宗』第4巻の90ページに、狐狸と鵬鳥の問題が乗っています。写真がオンラインで公開されていますので、気になる人は見てください: \url{http://edb.kulib.kyoto-u.ac.jp/exhibit/wa2/wa2cont.html} }。狐狸は$1$頭あたり$9$本の尾を、鵬鳥は$1$尾あたり$9$つの頭を持つので
\begin{align*}
\begin{cases}
x + 9y &= 72 \\
9x + y &= 88
\end{cases}
\end{align*}
という方程式が立つ。これを解いて$x = 9$, $y = 7$を得る。

\paragraph{問9} 絹織物の反数を$x$, 盗人の人数を$y$とおく\footnote{この問題の出典となった吉田光由『塵劫記』の初版は1627年に出版されています。しかし佐藤健一『『塵劫記』初版本 ---影印、現代文字、そして現代語訳---』(研成社) 237～238ページによれば、何度かの改訂の後、1641年の版で「絹盗人を知る算」が初登場するそうです。また塵劫記は、1645年版を底本として「岩波文庫 青24-1」で再版されています。これには222ページに「きぬぬす人を知る事」と書かれています。}。盗人たちの会話から
\begin{align*}
\begin{cases}
x - 8y &= -7 \\
x- 7y &= 8
\end{cases}
\end{align*}
という方程式が立つ。これを解いて$x = 113$, $y = 15$を得る。

\paragraph{問11} $1$番目の方程式から$7y - x = 6$が得られる。これに$x = ny$を代入すると$(7 - n)y = 6$となる。王子の人数と$1$人あたりのダイヤの個数は共に正の整数だから、これで$(7 - n, y)$の組合せが$(1, 6)$, $(2, 3)$, $(3, 2)$, $(6, 1)$に限られる。一方$k$番目の方程式は$y = k + \bigl(x - (k - 1)y - k\bigr)/7$と書けるので、この両辺を$\sum_{k = 1}^n$すると
\begin{align*}
ny &= \sum_{k = 1}^n \Bigl(k + \frac{x - (k - 1)y - k}{7}\Bigr)
= \sum_{k = 1}^n \Bigl(\frac{x + y}{7} + \frac{6 - y}{7} k\Bigr)
= \frac{n(x + y)}{7} + \frac{6 - y}{7}\frac{n(n + 1)}{2}
\end{align*}
となる。この両辺を$7$倍して$x = ny$を代入すると$7ny = n(n + 1)(3 + y/2)$を得る。さっきの$(7 - n, y)$の組合せでこの式を満たすものは、$(n, y) = (1, 1), (6, 6)$だけである。前者の場合$x = 1$で、後者の場合$x = 36$である。

\paragraph{問12} (1) $z$は任意で$(x, y) = (z + 3, z + 2)$ \quad (2) $(x, y, z) = (1/2, 1/2, 1/2)$ \quad (3) $x$, $y$は任意で$z = 3 - x - y$ \quad (4) $(x, y, z) = (1, 2, 4)$ \quad (5) $z$は任意で$(x, y) = (z + 1, z)$ \quad (6) $y$は任意で$x = 2y$

\paragraph{問13} (1) $(x, y, z) = (0, 0, 0)$ \quad (2) $z$は任意で$(x, y)=(z, z)$ \quad (3) $(x, y) = (0, 0)$

\subsection{問題を解くコツについて}

今回の問題の解き方は、基本的にどれも同じです。単に拡大係数行列に対して掃き出しを行えば良いだけの話ですので、答え以上の添削はほとんどしていません。

\paragraph{検算}

ややこしい計算だから当たり前ですが、結構計算ミスをする人がいました。しかしミス自体は一定の確率で起きてしまうものの、\textbf{解を元の方程式に代入すれば、正しいかどうかが判断できます}。これで答えを確かめるとよいでしょう。

\paragraph{間違えたときは}

この手の問題で計算ミスをすると、後から修正するのはかなり困難です。頑張って掃き出しを間違えた場所を探すより、\textbf{潔く諦めて最初から計算し直す}方が間違えずに済むと思います。ですので答えが間違っていた人は、最初から注意深くやり直してみましょう。

\section{掃き出し法}

今回のテーマは、連立$1$次方程式です。先週までと比べて急に易しくなった気がしますが、でも「変数の個数と方程式の本数が一般の場合」を考えるので「こどものお遊び」などと侮ってはいけません。何より、ここでの具体的な計算が、後々抽象論を展開するにも役立つのです。

\subsection{連立$1$次方程式の解法再考}

まずは連立$1$次方程式の中でも最も易しい、$2$変数の$2$本の連立$1$次方程式を解いてみましょう。繰り返しになりますが、「こどものお遊び」感がしても侮ってはいけません。問題が易しい分、観察の方をじっくりと読んでください。

\paragraph{問1 (3) の解答} 上の式を「式$1$」、下の式を「式$2$」と書くことにする。
\begin{align*}
\biggl\{
\begin{array}{@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x &+ &2y &= &3 \\
2x &+ &3y &= &4
\end{array}
\xrightarrow[\text{$(-2)$倍を加える}]{\text{式2に式1の}}
\biggl\{
\begin{array}{@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x &+ &2y &= &3 \\
 &- &y &= &-2
\end{array}
\xrightarrow[\text{$2$倍を加える}]{\text{式1に式2の}}
\biggl\{
\begin{array}{@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x &  & &= & -1 \\
 &- &y &= & -2
\end{array}
\xrightarrow[\text{$(-1)$倍する}]{\text{式2を}}
\biggl\{
\begin{array}{@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x & \hspace{1zw}  & &= & -1 \\
 &  & y &= & 2
\end{array}
\end{align*}
よって解は$x = -1$, $y = 2$である。 \qed

\paragraph{係数行列の考え方}

ここで、今の方程式の解き方を落ち着いて眺めると「実は$x$とか$y$とか書く必要なくて、単に係数だけ書き出せばいいんじゃないの？」という気がしてきます。実際その通りで、連立$1$次方程式を解くのに式全体を一々書く必要はありません。また、いまの方程式は行列を用いて
\[
\begin{pmatrix}
1 & 2 \\
2 & 3
\end{pmatrix}
\begin{pmatrix}
x \\
y 
\end{pmatrix}
=
\begin{pmatrix}
3 \\
4 
\end{pmatrix}
\]
と書けます。この式を$A\bm{x} = \bm{b}$と表せば、「係数だけ書き出す」という操作は、$A$と$\bm{b}$とを横に並べてできる行列$\tilde{A} := ( A \mid \bm{b})$を取り出す操作に相当します。

一般の場合も、連立$1$次方程式は必ず$A\bm{x} = \bm{b}$と書けます。この方程式$A\bm{x} = \bm{b}$に対し、$A$を\textbf{係数行列}といいます。また$A$と$\bm{b}$とを横に並べてできる行列$\tilde{A} := (A\ \bm{b})$を\textbf{拡大係数行列}と言います。ちょっとくどいですが、方程式を解く操作と拡大係数行列の変形とを並べて書き、「拡大係数行列だけ見ればよい」という事実を確認しましょう。もう$1$つ問題を解きます。

\paragraph{問1 (2) の解答} 次のようにして、$x = -1$, $y = 2$が解と分かる\footnote{拡大係数行列に縦線を入れたのは、見易さのためだけです。別に書かなくても構いません。}。
\begin{align*}
\biggl\{
\begin{array}{@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x &+ & 2y &= & 3 \\
3x &+ & 4y &= & 5 \\
\end{array} \xrightarrow[\text{$(-3)$倍を加える}]{\text{式2に式1の}}
&\biggl\{
\begin{array}{@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x &+ & 2y &= &3 \\
&- & 2y &= &-4 \\
\end{array} \xrightarrow[\text{$1$倍を加える}]{\text{\hbox to 10zw{\hfil 式1に式2の \hfil}}}
& & \biggl\{
\begin{array}{@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x &+ & &= & -1 \\
 &- & 2y &= & -4 \\
\end{array} \xrightarrow[\text{$(-1/2)$倍する}]{\text{\hbox to 8zw{\hfil 式2を \hfil}}}
\biggl\{
\begin{array}{@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x & \hspace{1zw} &  &= & -1 \\
 &  & y &= & 2 \\
\end{array}
\\
\biggl(
\begin{array}{rr|r}
1 & 2 & 3 \\
3 & 4 & 5 \\
\end{array}
\biggr) \xrightarrow[\text{$(-3)$倍を加える}]{\text{$2$行目に$1$行目の}}
&\biggl(
\begin{array}{rr|r}
1 & 2 & 3 \\
0 & -2 & -4 \\
\end{array}
\biggr)  \xrightarrow[\text{$1$倍を加える}]{\text{$1$行目に$2$行目の}}
& & \biggl(
\begin{array}{rr|r}
1 & 0 & -1 \\
0 & -2 & -4 \\
\end{array}
\biggr) \xrightarrow[\text{$(-1/2)$倍する}]{\text{$2$行目を}}
\biggl(
\begin{array}{rr|r}
1 & 0 & -1 \\
0 & 1 & 2 \\
\end{array}
\biggr)
\end{align*}
\qed

\paragraph{掃き出しと枢軸選択} 今の方程式を解く操作は、どちらも
\begin{itemize}
\item 式$1$の定数倍を式$2$に加えて、式$2$から$x$を消去する
\item 式$2$の定数倍を式$1$に加えて、式$1$から$y$を消去する
\end{itemize}
という順番で解いていました。もっと変数が多い場合でも、方程式が解を持つときは大体同じようにして解けます。つまり係数行列の側で見た時に
\begin{itemize}
\item $1$行目を適当に定数倍したものを他の行に加え、$1$行目以外の第$1$列の成分を全て$0$にする
\item $2$行目を適当に定数倍したものを他の行に加え、$2$行目以外の第$2$列の成分を全て$0$にする
\item ……
\end{itemize}
といった操作を繰り返すわけです。こうして拡大係数行列の右端以外の行に$1$つだけ$1$が残れば、$1$つの変数について、解が求まったことになります。この「第$i$行の定数倍を加え、$i$行目以外の$j$列目の成分を全て$0$にする」という操作を、「\textbf{$(i, j)$成分を要 (pivot) にした他の行の掃き出し}」といいます。連立$1$次方程式を解くには、$1$行目から順番に掃き出しをしていけばOKです。

ただし、たまに「$(1, 1)$成分を要にして他の行を掃き出したら、$(2, 2)$成分も消えてしまった」なんて現象が起きます。要とする成分が$0$では掃き出しができないので、こういうときは
\begin{itemize}
\item 行の入れ替えをして、$0$でない成分を次の行に持ってくる\footnote{連立$1$次方程式の側で見れば、方程式の並ぶ順番を入れ替えるだけです。この操作が解に影響しないことは明らかでしょう。}
\item $0$でない成分のある行を、次の要に選択する
\end{itemize}
といういずれかの操作をする必要があります。この操作を\textbf{枢軸選択 (pivotting)}といいます。枢軸選択の絡む方程式も、$1$つ解いてみましょう。

\paragraph{問4 (1) の解答}

次のようにして、解が$(x, y, z) = (1, 1, -1)$と分かる。
\begin{align*}
\Biggl(
\begin{array}{rrr|r}
1 & -2 & -4 & 3 \\
2 & -4 & -7 & 5 \\
4 & -7 & -13 & 10
\end{array}
\Biggr) \xrightarrow[\text{$2,3$行目を掃き出す}]{\text{$(1,1)$成分を要に}}
& \Biggl(
\begin{array}{rrr|r}
1 & -2 & -4 & 3 \\
0 & 0 & 1 & -1 \\
0 & 1 & 3 & -2
\end{array}
\Biggr) \xrightarrow[入れ替える]{\text{$2$行目と$3$行目を}}
\Biggl(
\begin{array}{rrr|r}
1 & -2 & -4 & 3 \\
0 & 1 & 3 & -2 \\
0 & 0 & 1 & -1
\end{array}
\Biggr) \\ \xrightarrow[\text{$1$行目を掃き出す}]{\text{$(2,2)成分を要に$}}
& \Biggl(
\begin{array}{rrr|r}
1 & 0 & 2 & -1 \\
0 & 1 & 3 & -2 \\
0 & 0 & 1 & -1
\end{array}
\Biggr) \xrightarrow[\text{他の行を掃き出す}]{\text{$(3,3)$成分を要に}}
\Biggl(
\begin{array}{rrr|r}
1 & 0 & 0 & 1 \\
0 & 1 & 0 & 1 \\
0 & 0 & 1 & -1
\end{array}
\Biggr)
\end{align*}
\qed

\paragraph{行基本変形}
ここまでで、連立$1$次方程式を解くのに必要な操作が全て出揃いました。係数行列だけを見て解くのにあたり、使っているのは
\begin{itemize}
\item $2$つの行を入れ替える
\item ある行に、別の行の定数倍を加える
\item ある行に$0$でない定数をかける
\end{itemize}
という操作の$3$つです。後で示すように、連立$1$次方程式が解けるときは、必ずこれらの組合せで事足ります。そこで、これらの$3$つを\textbf{行基本変形}といいます。

\subsection{行基本変形の行列による実現}

さて、実は\textbf{行基本変形は実は左からの行列の掛け算で実現できます}。それを問題で確認しましょう。ちょっとくどいですが「掃き出す操作」を行基本変形$1$つ$1$つに分解して、どのような行列の掛け算をすれば良いのか記してみます\footnote{ちなみに、行基本変形で登場する行列を\uline{右から}かけると、列基本変形をすることができます。今回は使いませんが、後で行列の階数の性質を詳しく調べるときに使います。}。

\paragraph{問5 (3) の解答} まずは掃き出しを行う。
\begin{align*}
\Biggl(
\begin{array}{rrrr}
2 & 1 & -3 & -2 \\
-3 & 2 & -1 & 2 \\
-1 & 3 & -4 & 0
\end{array}
\Biggr)
\xrightarrow[\text{\hbox to 10zw{\hfil $2$倍を加える \hfil}}]{\text{$1$行目に$3$行目の}} & 
\Biggl(
\begin{array}{rrr}
1 & 0 & 2 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrrr}
2 & 1 & -3 & -2 \\
-3 & 2 & -1 & 2 \\
-1 & 3 & -4 & 0
\end{array}
\Biggr)
& &=
\Biggl(
\begin{array}{rrrr}
0 & 7 & -11 & -2 \\
-3 & 2 & -1 & 2 \\
-1 & 3 & -4 & 0
\end{array}
\Biggr)\\
\xrightarrow[\text{\hbox to 10zw{\hfil $(-1)$倍する \hfil}}]{\text{$3$行目を}} & 
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & -1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrrr}
0 & 7 & -11 & -2 \\
-3 & 2 & -1 & 2 \\
-1 & 3 & -4 & 0
\end{array}
\Biggr)
& &=
\Biggl(
\begin{array}{rrrr}
0 & 7 & -11 & -2 \\
-3 & 2 & -1 & 2 \\
1 & -3 & 4 & 0
\end{array}
\Biggr)
\\ 
\xrightarrow[\text{\hbox to 10zw{\hfil $3$倍を加える \hfil}}]{\text{$2$行目に$3$行目の}} & 
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
0 & 1 & 3 \\
0 & 0 & 1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrrr}
0 & 7 & -11 & -2 \\
-3 & 2 & -1 & 2 \\
1 & -3 & 4 & 0
\end{array}
\Biggr)
& &=
\Biggl(
\begin{array}{rrrr}
0 & 7 & -11 & -2 \\
0 & -7 & 11 & 2 \\
1 & -3 & 4 & 0
\end{array}
\Biggr)
\\
\xrightarrow[\text{\hbox to 10zw{\hfil 入れ替える \hfil}}]{\text{$1$行目と$3$行目を}} & 
\Biggl(
\begin{array}{rrrr}
0 & 0 & 1 \\
0 & 1 & 0 \\
1 & 0 & 0
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrrr}
0 & 7 & -11 & -2 \\
0 & -7 & 11 & 2 \\
1 & -3 & 4 & 0
\end{array}
\Biggr)
& &=
\Biggl(
\begin{array}{rrrr}
1 & -3 & 4 & 0 \\
0 & -7 & 11 & 2 \\
0 & 7 & -11 & -2
\end{array}
\Biggr)
\\
\xrightarrow[\text{\hbox to 10zw{\hfil $1$倍を加える \hfil}}]{\text{$3$行目に$2$行目の}} & 
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 1 & 1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrrr}
1 & -3 & 4 & 0 \\
0 & -7 & 11 & 2 \\
0 & 7 & -11 & -2
\end{array}	
\Biggr)
& &=
\Biggl(
\begin{array}{rrrr}
1 & -3 & 4 & 0 \\
0 & -7 & 11 & 2 \\
0 & 0 & 0 & 0
\end{array}
\Biggr)
\\
\xrightarrow[\text{\hbox to 10zw{\hfil $(-1/7)$倍する \hfil}}]{\text{$2$行目を}} & 
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
0 & -\frac{1}{7} & 0 \\
0 & 0 & 1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrrr}
1 & -3 & 4 & 0 \\
0 & -7 & 11 & 2 \\
0 & 0 & 0 & 0
\end{array}
\Biggr)
& &=
\Biggl(
\begin{array}{rrrr}
1 & -3 & 4 & 0 \\
0 & 1 & -\frac{11}{7} & -\frac{2}{7} \\
0 & 0 & 0 & 0
\end{array}
\Biggr)
\\
\xrightarrow[\text{\hbox to 10zw{\hfil $3$倍を加える \hfil}}]{\text{$1$行目に$2$行目の}} & 
\Biggl(
\begin{array}{rrr}
1 & 3 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrrr}
1 & -3 & 4 & 0 \\
0 & 1 & -\frac{11}{7} & -\frac{2}{7} \\
0 & 0 & 0 & 0
\end{array}
\Biggr)
& &=
\Biggl(
\begin{array}{rrrr}
1 & 0 & -\frac{5}{7} & -\frac{6}{7} \\
0 & 1 & -\frac{11}{7} & -\frac{2}{7} \\
0 & 0 & 0 & 0
\end{array}
\Biggr)
\end{align*}
変形後の拡大係数行列を方程式で書き直すと
\begin{align*}
x - \frac{5}{7}z &= -\frac{6}{7} \\
y - \frac{11}{7}z &= -\frac{2}{7}
\end{align*}
となる。よって答えは、$z$をパラメータとして$x = (5z - 6)/7$, $y = (11z - 2)/7$である。 \qed

\paragraph{基本行列} いまの変形を見れば分かると思いますが、一般に、行列の$i$行目と$j$行目を入れ替えるには
\begin{align*}
P_{i,j} &:= 
%\begin{pmatrix}
\bordermatrix{
& & & & \scalebox{0.8}{$i^{\text{th}}$} & & & & \scalebox{0.8}{$j^{\text{th}}$} \\
& 1 & \\
& & \ddots  &  \\
& & & 1 \\
\scalebox{0.8}{$i^{\text{th}}$} & & & & 0 & & & & 1 \\
& & & & & 1 &  \\
& & & & & & \ddots &  \\
& & & & & & & 1  \\
\scalebox{0.8}{$j^{\text{th}}$} & & & & 1 & & & & 0 \\
& & & & & & & & & 1 \\
& & & & & & & & & & \ddots \\
& & & & & & & & & & & 1 
}
%\end{pmatrix}
\end{align*}
を左からかけます\footnote{何もないところには$0$が詰まっています。また左上から右下に並ぶ$1 \cdots 1$の個数は、時と場合によって変わります。点を並べてるくせに$1$個しかないこともありますし、$0$個のこともあります。}。また$i$行目の$c$倍、$i$行目に$j$行目の$c$倍を加える操作は、それぞれ
\begin{align*}
M_i(c) &:=
\bordermatrix{
& & & & \scalebox{0.8}{$i^{\text{th}}$} \\
& 1 & \\
& & \ddots \\
& & & 1 \\
\scalebox{0.8}{$i^{\text{th}}$} & & & & c \\
& & & & & 1 \\
& & & & & & \ddots \\
& & & & & & & 1
}, \quad
Q_{i,j}(c) :=
\bordermatrix{
&  &  & \scalebox{0.8}{$i^{\text{th}}$} & & \scalebox{0.8}{$j^{\text{th}}$} \\
& 1 & \\
& & \ddots \\
\scalebox{0.8}{$i^{\text{th}}$} & & & 1 &  & c \\
& & & & \ddots &  \\
\scalebox{0.8}{$j^{\text{th}}$} & & & & & 1 \\
& & & & & & \ddots \\
& & & & & & & 1
}
\end{align*}
という行列を左からかけることで実現できます。これら$3$種類の行列を\textbf{基本行列}\footnote{基本行列を表す記号は、必ずしも$P, Q, M$が使われるわけではありません。本によって授業はまちまちだと思います。}といいます。

\subsection{基本行列と逆行列}

連立$1$次方程式の中でも特別な場合として、係数行列が正方行列である場合を考えましょう。つまり変数の個数とちょうど同じ本数の方程式がある場合を考えます。このとき方程式を解く操作は「係数行列に行基本変形を施して、単位行列にする」ことに他なりません。そして行基本変形は左からの行列の積で表せますから、これは「係数行列の逆行列を考えていること」と同じになります。これを応用して、行基本変形を用いて逆行列を求めることができます。

\paragraph{行列のブロック分解}

少し今更感があり脇道に逸れますが、後で必要になるので行列のブロック分解の話をしておきます。たとえば$4$つの$2$次正方行列$A, B, C, D\in\Mat_2(\mathbb{R})$が与えられたとき、$A$と$B$、$C$と$D$を対角線上に並べると、大きい$4$次正方行列が作れます。そして
\begin{align*}
\begin{pmatrix}
A & O \\
O & B 
\end{pmatrix}
\begin{pmatrix}
C & O \\
O & D
\end{pmatrix}
=
\begin{pmatrix}
AC & O \\
O & BD
\end{pmatrix}
\end{align*}
という式が成り立ちます。もっと一般に、行列$A$と$B$を$A = (A_{ij})_{\substack{1\leq i \leq m \\ 1\leq j \leq n}}$, $B = (B_{ij})_{\substack{1\leq i \leq n \\ 1\leq j \leq l}}$という「ブロック (小さい行列)」に上手く分ける\footnote{ここでいう「上手く分ける」の意味は、「すぐ下の式に出てくるブロックごとの行列の積が定義されるように」という意味です。}と、$AB$の「$(i, j)$ブロック」が
\[
\sum_{k = 1}^n A_{ik} B_{kj}
\]
という形で表せます。\textbf{行列の積と全く同じ公式が、ブロック分解された行列の積についても成り立つのです}。典型的な例は「対角線に沿って正方行列が並ぶ場合」ですが、他にも知っておくと、計算の手間が省けることがあるでしょう。実際、すぐ後で使います。

\paragraph{逆行列の計算法}

正方行列$A$に対し、その逆行列とは$AA^{-1} = A^{-1}A = E$となる行列のことでした。逆行列はいつでも存在するとは限らず、逆行列が存在するような正方行列$A$は\textbf{正則}であるといいます。$A$が正則な場合、基本変形を用いると、次のようにして逆行列を求めることができます。

いま、$A$に基本行列$X_1, X_2, \ldots, X_k$を順番に左からかけて単位行列になったとします。つまり$X_k X_{k-1} \cdots X_1 A = E$です。すると$A^{-1} = X_k X_{k-1} \cdots X_1$だと分かります。ここでこの式の一番右に単位行列を補って$A^{-1} = X_k X_{k-1} \cdots X_1 E$とします。「各$X_i$が行基本変形に対応していた」ことを思い出せば、右辺は「単位行列に対する基本変形」を行っているように見えます。つまり「\textbf{$A$を単位行列にしたのと同じ手順の行基本変形を単位行列に施すと、$A$の逆行列が得られる}」と言っているわけです。こうして逆行列が求まります。

さらに基本変形で逆行列を求めるときに、一々「まず$A$を行基本変形で単位行列に変形して、その手順通りに単位行列にもう一度行基本変形を施す」なんてする必要はありません。\textbf{最初から$A$の右側に単位行列を並べ、一緒に行基本変形をしてしまえば良いのです}。実際、$A$と同じサイズの単位行列を並べた行列$(A \mid E)$に対して\footnote{ここでも縦線は、見易さのために入れているだけです。}、$A$を単位行列にするような基本変形をすれば
\[
X_k X_{k-1} \cdots X_1 (A \mid E) = (X_k X_{k-1} \cdots X_1 A \mid X_k X_{k-1} \cdots X_1 E) = (E \mid X_k X_{k-1} \cdots X_1)
\]
となります。\textbf{$A$が単位行列に変形されたのと同時に、元々右側にいた単位行列が$A^{-1}$に変形されるのです}。

この方法が機能することを確かめるため、$1$つ問題を解いてみましょう。

\paragraph{問4 (2) の解答} 係数行列と単位行列を横に並べ、同時に基本変形する。
\begin{align*}
& \Biggl(
\begin{array}{rrr|rrr}
1 & -2 & -9 & 1 & 0 & 0 \\
-2 & 4 & 19 & 0 & 1 & 0 \\
-2 & 5 & 25 & 0 & 0 & 1
\end{array}
\Biggr) \\
\xrightarrow[\text{$2, 3$行目を掃き出す}]{\text{\hbox to 10zw{\hfil $(1, 1)$成分を要に \hfil}}}
&
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
2 & 1 & 0 \\
2 & 0 & 1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr|rrr}
1 & -2 & -9 & 1 & 0 & 0 \\
-2 & 4 & 19 & 0 & 1 & 0 \\
-2 & 5 & 25 & 0 & 0 & 1
\end{array}
\Biggr)
& =
\Biggl(
\begin{array}{rrr|rrr}
1 & -2 & -9 & 1 & 0 & 0 \\
0 & 0 & 1 & 2 & 1 & 0 \\
0 & 1 & 7 & 2 & 0 & 1
\end{array}
\Biggr)
\\
\xrightarrow[\text{入れ替える}]{\text{\hbox to 10zw{\hfil $1$行目と$2$行目を \hfil}}}
&
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr|rrr}
1 & -2 & -9 & 1 & 0 & 0 \\
0 & 0 & 1 & 2 & 1 & 0 \\
0 & 1 & 7 & 2 & 0 & 1
\end{array}
\Biggr)
& =
\Biggl(
\begin{array}{rrr|rrr}
1 & -2 & -9 & 1 & 0 & 0 \\
0 & 1 & 7 & 2 & 0 & 1 \\
0 & 0 & 1 & 2 & 1 & 0
\end{array}
\Biggr)
\\
\xrightarrow[\text{$1$行目を掃き出す}]{\text{\hbox to 10zw{\hfil $(2, 2)$成分を要に \hfil}}}
&
\Biggl(
\begin{array}{rrr}
1 & 2 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr|rrr}
1 & -2 & -9 & 1 & 0 & 0 \\
0 & 1 & 7 & 2 & 0 & 1 \\
0 & 0 & 1 & 2 & 1 & 0
\end{array}
\Biggr)
& =
\Biggl(
\begin{array}{rrr|rrr}
1 & 0 & 5 & 5 & 0 & 2 \\
0 & 1 & 7 & 2 & 0 & 1 \\
0 & 0 & 1 & 2 & 1 & 0
\end{array}
\Biggr)
\\
\xrightarrow[\text{$1, 2$行目を掃き出す}]{\text{\hbox to 10zw{\hfil $(3, 3)$成分を要に \hfil}}}
&
\Biggl(
\begin{array}{rrr}
1 & 0 & -5 \\
0 & 1 & -7 \\
0 & 0 & 1
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr|rrr}
1 & 0 & 5 & 5 & 0 & 2 \\
0 & 1 & 7 & 2 & 0 & 1 \\
0 & 0 & 1 & 2 & 1 & 0
\end{array}
\Biggr)
& =
\Biggl(
\begin{array}{rrr|rrr}
1 & 0 & 0 & -5 & -5 & 2 \\
0 & 1 & 0 & -12 & -7 & 1 \\
0 & 0 & 1 & 2 & 1 & 0
\end{array}
\Biggr)
\end{align*}
こうして係数行列の逆行列が求まるので、これを拡大係数行列にかけて
\[
\Biggl(
\begin{array}{rrr}
-5 & -5 & 2 \\
-12 & -7 & 1\\
2 & 1 & 0
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrrr}
1 & -2 & -9 & 5 \\
-2 & 4 & 19 & -11 \\
-2 & 5 & 25 & -14 
\end{array}
\Biggr)
=
\Biggl(
\begin{array}{rrrr}
1 & 0 & 0 & 2 \\
0 & 1 & 0 & 3 \\
0 & 0 & 1 & -1
\end{array}
\Biggr)
\]
を得る\footnote{逆行列が得られたことは理論的には分かっているのですが、これが本当に逆行列になっていることは、一度は直接計算で確かめるべきです。}。答えは$x = 2$, $y = 3$, $z = -1$である。 \qed


\paragraph{基本行列の逆行列}

$2$次正方行列の場合には、正則なことと$\det A \neq 0$とが同値であることを (大分昔になりますが) 「数理科学基礎 (線形代数学) 第5回」の配布プリント\pageref{paragraph:existence_of_inverse_matrix}ページにて直接証明しました。一般の場合も同様に行列式を用いて正則性の判定ができますが、高次の行列式を定義しないと、その手法は使えません。

が、基本行列に関してはこんな一般論をゴタゴタ使わずとも、直に逆行列が計算できてしまいます。基本行列は「行基本変形」と対応します。そして\textbf{「行基本変形を元に戻す操作」もまた行基本変形です}。そこで行基本変形を「どう戻せばいいか」を考えれば、基本行列の逆行列に当たりが付きます。

まず「$i$行目と$j$行目」の入れ替えは、同じ操作を$2$度繰り返せば元に戻ります。実際、基本行列でも
\[
\begin{pmatrix}
0 & & & & 1 \\
& 1 & & \\
& & \ddots & \\
& & & 1 \\
1 & & & & 0
\end{pmatrix}
\begin{pmatrix}
0 & & & & 1 \\
& 1 & & \\
& & \ddots & \\
& & & 1 \\
1 & & & & 0
\end{pmatrix}
=
\begin{pmatrix}
1 & & & & \\
& 1 & & \\
& & \ddots & \\
& & & 1 \\
& & & & 1
\end{pmatrix}
\]
となっています\footnote{元々の基本行列は、いまの行列の左上と右下に単位行列がありました。しかし行列の積をブロック分割して考えれば、左下と右下のブロックでの計算は「単位行列を$2$個かけたら単位行列になる」というだけの結果になります。だから中央のブロックだけ取ってくれば十分です。}。次に、$i$行目に$j$行目の$c$倍を加える基本変形の逆は、$i$行目に$j$行目の$-c$倍を加える基本変形です。$i$行目に$j$行目の$c$倍を加えた後$-c$倍を加えたら、元に戻りますよね。それを反映して
\[
\begin{pmatrix}
1 & & c \\
 & \ddots & \\
 & & 1
\end{pmatrix}
\begin{pmatrix}
1 & & -c \\
 & \ddots & \\
 & & 1
\end{pmatrix}
=
\begin{pmatrix}
1 & & \\
 & \ddots & \\
 & & 1
\end{pmatrix}
\]
となります。そして最後に、$i$行目を$c$倍する基本変形の逆は、$i$行目を$1/c$倍する操作です。行列でこれを表すと
\[
\begin{pmatrix}
1 & & \\
 & \ddots & \\
 & & 1 \\
 & & & c \\
 & & & & 1 \\
 & & & & & \ddots \\
 & & & & & & 1 \\
\end{pmatrix}
\begin{pmatrix}
1 & & \\
 & \ddots & \\
 & & 1 \\
 & & & \frac{1}{c} \\
 & & & & 1 \\
 & & & & & \ddots \\
 & & & & & & 1 \\
\end{pmatrix}
=
\begin{pmatrix}
1 & & \\
 & \ddots & \\
 & & 1 \\
 & & & 1 \\
 & & & & 1 \\
 & & & & & \ddots \\
 & & & & & & 1 \\
\end{pmatrix}
\]
となります。まとめると
\[
P_{k,l}^2 = E, Q_{k, l}(c)Q_{k, l}(-c) = E, M_k(c)M_k(1/c) = E
\]
という関係式が得られます。これで全ての基本行列について逆行列が得られました。

\subsection{LU分解}

さて、ここで連立$1$次方程式のうち、枢軸選択が要らない問題を考えます。この問題も当然掃き出しでは解けるのですが、掃き出す順序を
\begin{enumerate}
\item $1$行目から順に対角線に沿って、下の方だけを先に掃き出し
\item その後でまた$2$行目から順に対角線に沿って、対角線より上の方を掃き出す
\end{enumerate}
という順番で行ってみます。

\paragraph{問3 (3) の解答}

\begin{align*}
\Biggl(
\begin{array}{rrrr}
1 & 3 & 2 & -1 \\
-3 & -8 & -4 & 0 \\
2 & 5 & 3 & -1
\end{array}
\Biggr)
\xrightarrow[\text{$2, 3$行目を掃き出す}]{\text{$(1, 1)$成分を要に}}
& \Biggl(
\begin{array}{rrrr}
1 & 3 & 2 & -1 \\
0 & 1 & 2 & -3 \\
0 & -1 & -1 & 1
\end{array}
\Biggr)
\xrightarrow[\text{$3$行目だけを掃き出す}]{\text{$(2, 2)$成分を要に}}
\Biggl(
\begin{array}{rrrr}
1 & 3 & 2 & -1 \\
0 & 1 & 2 & -3 \\
0 & 0 & 1 & -2
\end{array}
\Biggr)
\end{align*}
これで下半分の掃き出しが済んだ。続けて掃き出しを行うと
\begin{align*}
\Biggl(
\begin{array}{rrrr}
1 & 3 & 2 & -1 \\
0 & 1 & 2 & -3 \\
0 & 0 & 1 & -2
\end{array}
\Biggr)
\xrightarrow[\text{$1$行目を掃き出す}]{\text{$(2, 2)$成分を要に}}
\Biggl(
\begin{array}{rrrr}
1 & 0 & -4 & 8 \\
0 & 1 & 2 & -3 \\
0 & 0 & 1 & -2
\end{array}
\Biggr)
\xrightarrow[\text{$1, 2$行目を掃き出す}]{\text{$(3, 3)$成分を要に}}
\Biggl(
\begin{array}{rrrr}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 1 \\
0 & 0 & 1 & -2
\end{array}
\Biggr)
\end{align*}
となる。 \qed

\paragraph{LU分解} % Bruhat 分解のことも少しだけ紹介

今の問題を解く基本変形を「下半分の掃き出し」のところで止めてみます。これを基本行列の積で書くと
\begin{align*}
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 1 & 1 
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
3 & 1 & 0 \\
-2 & 0 & 1 
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr}
1 & 3 & 2 \\
-3 & -8 & -4 \\
2 & 5 & 3 
\end{array}
\Biggr)
=
\Biggl(
\begin{array}{rrr}
1 & 3 & 2 \\
0 & 1 & 2 \\
0 & 0 & 1 
\end{array}
\Biggr)
\end{align*}
となります。この両辺に左から、基本変形の逆行列をかけると\footnote{行列の積は非可換なので、$AB$の逆行列は$(AB)^{-1} = B^{-1}A^{-1}$となります。順番に気を付けましょう。}
\begin{align*}
\Biggl(
\begin{array}{rrr}
1 & 3 & 2 \\
-3 & -8 & -4 \\
2 & 5 & 3 
\end{array}
\Biggr)
&=
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
-3 & 1 & 0 \\
2 & 0 & 1 
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & -1 & 1 
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr}
1 & 3 & 2 \\
0 & 1 & 2 \\
0 & 0 & 1 
\end{array}
\Biggr)
=
\Biggl(
\begin{array}{rrr}
1 & 0 & 0 \\
-3 & 1 & 0 \\
2 & -1 & 1 
\end{array}
\Biggr)
\Biggl(
\begin{array}{rrr}
1 & 3 & 2 \\
0 & 1 & 2 \\
0 & 0 & 1 
\end{array}
\Biggr)
\end{align*}
というように、元の方程式の係数行列を\textbf{下三角行列と上三角行列の積に分解}できます\footnote{この式は作り方からして正しい式なのですが、直接計算でも正しさを確かめてみてください。}。

今の手順を振り返って、何でこのような分解ができたのかを考えてみましょう。右側に上三角行列が出てきた理由は言うまでもなく、わざと行列の下半分だけ掃き出したからです。一方、左側に出てきた行列が下三角行列になるのは
\begin{itemize}
\item 「対角線の下側を掃き出す」という操作に登場する基本行列が、下三角行列で表されること
\item その時に登場する基本行列の逆行列が、また下三角行列であること
\item 下三角行列同士の積が再び下三角行列になること
\end{itemize}
という理由によるものです。だから一般の正則行列の場合でも、枢軸選択が不要な限りにおいて、「下半分だけを掃き出す」という操作で下三角 (\underline{L}ower triangular) 行列と上三角 (\underline{U}pper triangular) 行列への分解が得られます。これを\textbf{LU分解}といいます。また、係数行列の下半分が掃き出せた段階で、方程式は
\begin{align*}
\Biggl(
\begin{array}{rrrr}
1 & 3 & 2 & -1 \\
0 & 1 & 2 & -3 \\
0 & 0 & 1 & -2
\end{array}
\Biggr)
\leftrightarrow
\Biggl\{
\begin{array}{r@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r@{\,}r}
x & + & 3y & + & 2z & = & -1 \\
& & y & + & 2z & = & -3 \\
& & & & z & = & -2
\end{array}
\end{align*}
という格好をしています。ここまで来れば、あとは掃き出すまでもありません。一番下を解けば$z$が求まり、その$z$を真ん中に代入すれば$y$が求まり、$y, z$を一番上に代入すれば$x$が求まります。このようにLU分解の後、下から順に方程式を解く手法を\textbf{Gaussの消去法}といいます。この手法はコンピュータで連立$1$次方程式を解く際、よく使います。

\section{行列の核、像と階数}

線型写像に対しては核と像が定義され、核は定義域の、像は値域の部分空間となるのでした。行列の掛け算は線型写像ですから、行列に対しても当然その核や像が定義でき、これらは線型空間になります。

前の章では計算手順等を説明するため、意図的に上手く解ける問題ばかりを選んで解説しました。ですが世の中の連立$1$次方程式は、解をとてもたくさん持つ場合や、逆に解を全く持たない場合もあります。今度は線型写像の核と像を用いて、解の存在状況を解析しましょう。

\subsection{行列の像と連立$1$次方程式の解}

連立$1$次方程式\footnote{話を簡単にするため変数と方程式の本数を両方とも$3$としていますが、以下の議論は、一般の場合でも全く同様に成り立ちます。}
\begin{align*}
a_{11} x_1 + a_{12} x_2 + a_{13} x_3 &= b_1 \\
a_{21} x_1 + a_{22} x_2 + a_{23} x_3 &= b_2 \\
a_{31} x_1 + a_{32} x_2 + a_{33} x_3 &= b_3
\end{align*}
を、いつものように行列で$A\bm{x} = \bm{b}$と表しましょう。そしてここで、$A$の列ベクトルを$1$列目から順に$\bm{a}_1$, $\bm{a}_2$, $\bm{a}_3$とし、行列$A$を$A = ( \bm{a}_1 \ \bm{a}_2 \ \bm{a}_3 )$と表します。そうすると
\[
A
\begin{pmatrix}
x_1 \\
x_2 \\
x_3
\end{pmatrix}
=
\begin{pmatrix}
a_{11} x_1 + a_{12} x_2 + a_{13} x_3 \\
a_{21} x_1 + a_{22} x_2 + a_{23} x_3 \\
a_{31} x_1 + a_{32} x_2 + a_{33} x_3
\end{pmatrix}
= 
x_1 \bm{a}_1 + x_2 \bm{a}_2 + x_3 \bm{a}_3
\]
となります。ここで一旦方程式のことを忘れ、$\bm{x}$を$3$次元空間$\mathbb{R}^3$の中で動かします。そうしてできる$A\bm{x}$全部を集めてできる集合は、$A$の像$\Im A$に他なりません。一方$x_1\bm{a}_1 + x_2 \bm{a}_2 + x_3 \bm{a}_3$で$x_1, x_2, x_3$を動かしてできるのは、ベクトル$\bm{a}_1$, $\bm{a}_2$, $\bm{a}_3$の張る空間です。ですから\textbf{行列$A$の像は、$A$の列ベクトルたちが張る空間と一致します}。式で書けば$\Im A = \mathbb{R}\bm{a}_1 + \mathbb{R}\bm{a}_2 + \mathbb{R}\bm{a}_3$です。

そして方程式$A\bm{x} = \bm{b}$に話を戻すと、この方程式が解を持つことは、$\bm{b}$が$A$の像に入ることに他なりません。一方$\Im A = \mathbb{R}\bm{a}_1 + \mathbb{R}\bm{a}_2 + \mathbb{R}\bm{a}_3$ですから、これらを合わせて考えると「像$\Im A$が大きいほど、方程式$A\bm{x} = \bm{b}$は解を持ちやすくなる」と想像ができます。

また$\bm{a}_1$, $\bm{a}_2$, $\bm{a}_3$が$\Im A$を張るときに「無駄」がある場合もあります。もし$\bm{a}_1$, $\bm{a}_2$, $\bm{a}_3$が$1$次独立でなければ、$\alpha_1 \bm{a}_1 + \alpha_2 \bm{a}_2 + \alpha_3 \bm{a}_3 = \bm{0}$となる、全てが$0$ではない実数$\alpha_1, \alpha_2, \alpha_3 \in\mathbb{R}$が存在します。これは言い換えれば${}^t(\alpha_1, \alpha_2, \alpha_3)\in \Ker A$となります。核の方向にベクトルを動かしても像は変わりませんから、核の方向にパラメータが生じることが想像できるわけです。

\subsection{(拡大) 係数行列の階数と解の存在}

\paragraph{行列の階数}

行列$A$に対し、$\Im A$がどれだけ大きいかを測るのが「階数」と呼ばれる量です。行列$A$を列ベクトルの並びで$A = (\bm{a}_1 \ \bm{a}_2 \ \cdots \ \bm{a}_n)$と表します。このとき列ベクトル$\bm{a}_1, \bm{a}_2, \ldots, \bm{a}_n$のうち、$1$次独立な組合せの最大本数を行列$A$の\textbf{階数} (rank) といい、$\rank A$で表します。

後で線型空間の「次元」を定義すると、$\rank A$は線型空間$\Im A$の次元と一致します。まだきちんと説明していないものの、「空間内における$1$次独立なベクトルの最大本数が次元である」という文章は、何となく分かるのではないでしょうか。たとえば僕たちの住んでいる空間$\mathbb{R}^3$は「$3$次元」と言われます。このことが「$\mathbb{R}^3$内で$1$次独立なベクトルは$3$本までしか取れない」という事実と対応するのは、直感的には明らかでしょう。ですから$\rank A$の大小は$\Im A$の次元の大小と同じで、したがって$\Im A$がどれだけ広いかを反映しています。

また\textbf{ある行列に正則行列を左からかけても、階数は変わりません}。このことを確かめましょう。一般に$X$を正則な$n$次正方行列、$\bm{v}_1,\ldots,\bm{v}_k\in\mathbb{R}^n$をベクトルとするとき、$X$は逆行列を持つので、
\begin{align*}
\alpha_1 \bm{v}_1 + \alpha_2 \bm{v}_2 + \cdots + \alpha_k \bm{v}_k &= \bm{0} \\
X(\alpha_1 \bm{v}_1 + \alpha_2 \bm{v}_2 + \cdots + \alpha_k \bm{v}_k) &= \bm{0}
\end{align*}
という$2$式が同値になります。一方、$2$つ目の式は$\alpha_1 (X\bm{v}_1) + \alpha_2 (X\bm{v}_2) + \cdots + \alpha_k (X\bm{v}_k) = \bm{0}$と書き直せます。だから$\bm{v}_1, \bm{v}_2, \ldots, \bm{v}_k$の$1$次独立性と$X\bm{v}_1, X\bm{v}_2, \ldots, X\bm{v}_k$の$1$次独立性は同値です。そして行列$XA$は、$A$の各列ベクトルをそれぞれ$X$倍して得られます。だから「$A$の列ベクトルの組合せが$1$次独立であるかどうか」は、「同じ位置にある$XA$の列ベクトルの組合せが$1$次独立であるかどうか」で判定できます。

\paragraph{連立$1$次方程式の解の存在判定}

いま、連立$1$次方程式$A\bm{x} = \bm{b}$を考えましょう。拡大係数行列を$\tilde{A} = ( A \ \bm{b} )$とおくと、$\tilde{A}$は$A$に列ベクトルを$1$本付け加えただけなので、$\rank \tilde{A} = \rank A$または$\rank \tilde{A} = \rank A + 1$のいずれかが成り立ちます。一方$\bm{b} \in \Im A$かそうでないかが、$A$の列ベクトルたちに$\bm{b}$を加えた時、$1$次独立なベクトルの最大本数が増えるかどうかと対応しています。したがって$\rank \tilde{A} = \rank A + 1$なら$\bm{b} \not\in \Im A$であり、方程式$A\bm{x} = \bm{b}$が解を持たないと結論付けることができます。逆に$\rank \tilde{A} = \rank A$なら$\bm{b} \in \Im A$で、方程式$A\bm{x} = \bm{b}$は解を持ちます。

そして連立$1$次方程式を掃き出し法で解くとき、拡大係数行列$\tilde{A}$は基本変形されて姿を変えていきます。ですが基本変形は左からの基本行列の積で書けること、そして基本行列が正則なことを合わせると、基本変形の前後で (拡大) 係数行列の階数は変わりないと分かります。だから連立$1$次方程式の解の存在を判定するには、\textbf{拡大係数行列を適当に見やすく基本変形し、一番右の列の有無で階数が変化するかを調べれば良い}のです。

この方針で、$1$つ問題を解いてみましょう。

\paragraph{問5 (2) の解答} 拡大係数行列を基本変形すると
\begin{align*}
\Biggl(
\begin{array}{rrrr}
3 & 1 & 5 & -1 \\
2 & 1 & 6 & 0 \\
5 & 2 & 11 & 3 \\
\end{array}
\Biggr)
\xrightarrow[]{}
\Biggl(
\begin{array}{rrrr}
3 & 1 & 5 & -1 \\
2 & 1 & 6 & 0 \\
2 & 1 & 6 & 3 \\
\end{array}
\Biggr)
\xrightarrow[]{}
\Biggl(
\begin{array}{rrrr}
3 & 1 & 5 & -1 \\
2 & 1 & 6 & 0 \\
0 & 0 & 0 & 3 \\
\end{array}
\Biggr)
\end{align*}
となる。ここで係数行列の部分
\begin{align*}
\Biggl(
\begin{array}{rrrr}
3 & 1 & 5 \\
2 & 1 & 6 \\
0 & 0 & 0
\end{array}
\Biggr)
\end{align*}
だけ取り出すと、全ての列ベクトルが空間$\mathbb{R}^3$内の$xy$平面に含まれている。そして係数行列の左上$2\times 2$ブロックの行列式を計算すると$1$になるから、第$1$列と第$2$列の列ベクトルが$1$次独立だと分かる。したがって係数行列の階数は$2$である。

一方、拡大係数行列の一番右の列ベクトル${}^t(-1, 0, 3)$は第$3$成分が$0$でない。よって拡大係数行列の第$1$列、第$2$列、第$4$列の列ベクトル
\begin{align*}
\begin{pmatrix}
3 \\
2 \\
0
\end{pmatrix}, 
\begin{pmatrix}
1 \\
1 \\
0
\end{pmatrix}, 
\begin{pmatrix}
-1 \\
0 \\
3
\end{pmatrix}
\end{align*}
たちは$1$次独立である。また空間$\mathbb{R}^3$内で$4$本の$1$次独立なベクトルは取れないから、これで拡大係数行列の階数が$3$と決まる。

以上で、係数行列と拡大係数行列の階数が異なることが分かった。これは$\bm{b} \not\in \Im A$を意味するので、方程式$A\bm{x} = \bm{b}$は解を持たない。 \qed

\subsection{行列の核と解の任意性}

今度は解がパラメータを持つ場合を考えましょう。連立$1$次方程式$A\bm{x} = \bm{b}$が複数の解を持つとき、そのうち異なる$2$個を$\bm{x}_1, \bm{x}_2$とおくと、$A\bm{x}_1 = A\bm{x}_2 = \bm{b}$です。したがってベクトルを$A$倍する写像は単射でありません。そして$A$倍写像の単射でない具合は$\Ker A$を調べれば分かるのでした。特に$\bm{b} = \bm{0}$の場合、方程式を解くことは$\Ker A$をことそのものです。この方針で、問題を$1$つ解いてみましょう。

\paragraph{問6 (2) の解答}
問題の方程式を行列$A\bm{x} = \bm{0}$と表す。右辺は$\bm{0}$ベクトルだから拡大係数行列を考える意味はなく、係数行列だけを変形すれば良い。
\begin{align*}
\left(
\begin{array}{rrrr}
1 & 2 & -5 & 3 \\
2 & -1 & 1 & 2 \\
3 & 1 & -4 & 5 \\
2 & 4 & -10 & 6 \\
\end{array}
\right)
\xrightarrow[\text{他の行を掃き出し}]{\text{$(1, 1)$成分を要に}}
\left(
\begin{array}{rrrr}
1 & 2 & -5 & 3 \\
0 & -5 & 11 & -4 \\
0 & -5 & 11 & -4 \\
0 & 0 & 0 & 0 \\
\end{array}
\right)
\xrightarrow[\text{$2$行目を引く}]{\text{$3$行目から}}
\left(
\begin{array}{rrrr}
1 & 2 & -5 & 3 \\
0 & -5 & 11 & -4\\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
\end{array}
\right) \\
\xrightarrow[\text{$(-1/5)$倍する}]{\text{$2$行目を}}
\left(
\begin{array}{rrrr}
1 & 2 & -5 & 3 \\
0 & 1 & -\frac{11}{5} & \frac{4}{5} \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
\end{array}
\right)
\xrightarrow[\text{$1$行目を掃き出す}]{\text{$(2, 2)$成分を要に}}
\left(
\begin{array}{rrrr}
1 & 0 & -\frac{3}{5} & \frac{7}{5} \\
0 & 1 & -\frac{11}{5} & \frac{4}{5} \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
\end{array}
\right)
\end{align*}
変形後の係数行列の第$1$列から第$4$列を、それぞれ$\bm{a}_1$, $\bm{a}_2$, $\bm{a}_3$, $\bm{a}_4$と表す。そうすると
\[
\bm{a}_3 = -\frac{3}{5} \bm{a}_1 -\frac{11}{5} \bm{a}_2, 
\bm{a}_4 = \frac{7}{5} \bm{a}_1 + \frac{4}{5} \bm{a}_2
\]
である。よって
\[
\bm{v}_1 :=
\begin{pmatrix}
3/5 \\
11/5 \\
1 \\
0
\end{pmatrix}, 
\bm{v}_2 :=
\begin{pmatrix}
-7/5 \\
-4/5 \\
0 \\
1
\end{pmatrix}
\in \Ker A
\]
が従う。これらのベクトルは、第$3$, $4$成分を見ることで$1$次独立と分かる。

一方背理法で、$\Ker A$の中からこれ以上$1$次独立なベクトルを取れないことが示せる。仮にそのようなベクトル$\bm{v}_3 = {}^t(u_1, u_2, u_3, u_4)$があったとする。$\bm{v}_1$と$\bm{v}_2$の$1$次結合を$\bm{v}_3$に足しても、$\bm{v}_1$, $\bm{v}_2$と$\bm{v}_3$が$1$次独立であることに変わりはない。したがって
\[
\bm{v}_3 - u_3 \bm{v}_1 - u_4 \bm{v}_2 = 
\begin{pmatrix}
u_1 \\
u_2 \\
u_3 \\
u_4
\end{pmatrix}
-
\begin{pmatrix}
3/5 \\
11/5 \\
1 \\
0
\end{pmatrix}
-
\begin{pmatrix}
-7/5 \\
-4/5 \\
0 \\
1
\end{pmatrix}
=
\begin{pmatrix}
* \\
* \\
0 \\
0
\end{pmatrix}
\]
と$\bm{v}_1$, $\bm{v}_2$も一次独立なベクトルの組である\footnote{第$1, 2$行目の値は計算できますが、後々の議論において「具体的な値が何になるか」は重要でありません。ただ「どちらかの成分が$0$ではないこと」だけが重要なので「具体的な値はどうでもいい」という意味を込めて、$*$という記号を書いています。}。しかし、これが$\Ker A$に属するということは
\[
\bm{0}
=
A
\begin{pmatrix}
* \\
* \\
0 \\
0
\end{pmatrix}
=
{*\bm{a}_1} + {*\bm{a_2}}
\]
を意味する。$\bm{a}_1$, $\bm{a_2}$の係数の少なくとも一方は$0$でないから、$\bm{a}_1$と$\bm{a}_2$は$1$次独立ではない。しかし$\bm{a}_1 = {}^t(1, 0, 0, 0)$, $\bm{a}_2 = {}^t(0, 1, 0, 0)$は明らかに$1$次独立なので、これは矛盾している。したがって$\Ker A$の元は、全て$\bm{v}_1$と$\bm{v}_2$の$1$次結合で書ける。これで解が
\[
z\bm{v}_1 + w\bm{v}_2
=
\begin{pmatrix}
(3z - 7w)/5 \\
(11z - 4w)/5 \\
z \\
w
\end{pmatrix}
\quad (z, w\in\mathbb{R})
\]
と求まった。 \qed

\paragraph{解のパラメータと核の基底の対応}

今の問題をよくよく観察すると
\begin{itemize}
\item 連立$1$次方程式がパラメータを持つのは、係数行列の列ベクトルたちが$1$次独立でない場合である
\item 列ベクトルの$1$次従属な組合せと、$\Ker A$のベクトルとが$1:1$に対応する
\item $\Ker A$を無駄なく張るベクトルを集めると、それらの$1$次結合を作るときの係数が解のパラメータになる
\end{itemize}
ことが分かります。この考え方を推し進めると、核と像がどのように関係するかを詳しく知ることができます。

ただ、そろそろ「基底」という言葉を使わずに説明を書くのが苦しい状況になってきました。次回の演習問題で基底の扱いを学びますので、今回はここで話をやめ、次元に関する話は先送りにしたいと思います。

