\chapter{余因子展開の応用}
\lectureinfo{2015年10月7日 1限}

\section{今回の問題について}

\subsection{計算ミスを防ぐために}

今回の問題はどれも計算問題でしたが、計算の仕方を間違えたり、計算方法が正しくても答えを間違えてしまった人が後を絶ちませんでした。計算ミスを防ぐのに役立つ一般的なテクニックを紹介しますので、目を通してください。

\paragraph{検算をする}

逆行列を求める問題とか方程式を解く問題は、全て検算ができます。逆行列の計算なら元の行列にかければ良いわけですし、方程式を解く問題なら求まった解を元の方程式に代入すれば良いわけです。この程度の簡単なチェックは怠らないでください。

\paragraph{理論をよく知る}

よく「理論と計算」は対比されますが、理論を知っていることは計算にも役立ちます。たとえば今回の場合に、理論が使える場面を挙げてみます。
\begin{itemize}
\item ある行列の逆行列は、存在すればいつでも正則です。ですから「逆行列の計算」の答えとして、$2$つの行/列が比例したり、ある行/列が丸ごと$0$であるといった明らかに非正則な行列が出てくることはありません。
\item 複素数と$2$次正方行列の間に
\[
x + iy \longleftrightarrow
\begin{pmatrix}
x & -y \\
y & x
\end{pmatrix}
\]
という対応をつけると和や積の演算までぴったり対応します。これを知っていれば逆行列の計算をしなくても、複素数の$z^{-1} = \overline{z}/|z|^2$という式から答えが導けます。
\item 上三角行列の逆行列はいつでも上三角行列です。
\item ブロック対角行列\footnote{対角線上に正方行列がいくつか並んでいて、かつ他の成分が全て$0$であるような行列のことです。}の逆行列は、個別のブロックごとに逆行列を計算すれば求まります。
\end{itemize}
これらの結果は、いずれも線型代数の主要な定理から簡単に導かれるものです。ですがその簡単さとは裏腹に、初等的な計算ミスを効果的に検出してくれます。

\subsection{問題の解答} \label{subsection:non-trivial_answer}

「自明でない (非自明な) 解」という言葉に慣れていない人がいたので、補足しておきます。連立$1$次方程式$A\bm{x} = \bm{0}$を考えるとき、$\bm{x} = \bm{0}$は明らかにこの方程式の解です。$\bm{0}$ベクトルにどんな行列をかけても$\bm{0}$ですよね。というわけで、この$\bm{x} = \bm{0}$のことを\textbf{自明な解}と呼びます。そして自明な解以外の解を、\textbf{非自明な解}\index{ひじめいなかい@非自明な解}といいます。

特に$A$が$n$次正方行列の場合、$A$が正則なら非自明な解は存在しません。なぜなら$A\bm{x} = \bm{0}$から$\bm{x} = A^{-1}\bm{0} = \bm{0}$が導かれるからです。ですから連立$1$次方程式$A\bm{x} = \bm{0}$が非自明な解を持つためには、$A$が非正則なことが必要です。一方正方行列では、全射性と単射性が同時にしか成り立たないのでした。したがって$A$が非正則なら$A$は単射でないので、$\Ker A \neq 0$です。これは$A\bm{x} = \bm{0}$の解が$\bm{0}$以外に存在することを意味します。よって非自明な解が存在するための必要十分条件は、$A$が正則でないことです。

そして正方行列の正則性は、$\det$が$0$でないかどうかで判定できます。ですから非自明な解が存在するための条件を求めるには$\det$を計算し、それが$0$になるようなパラメータを見つければ良いのです。

\paragraph{問1の解答}
係数行列の行列式が$0$のときに限り、非自明な解が存在する。そのときの$k$の値は (1) $k = \pm1$ (2) $k = 0, \pm2$ である。

\paragraph{問2の解答}

\[
\frac{1}{3}
\begin{pmatrix}
2 & 1 \\
1 & 2
\end{pmatrix}, 
\frac{1}{x^2 + y^2}
\begin{pmatrix}
x & y \\
-y & x
\end{pmatrix}, 
\frac{1}{2}
\begin{pmatrix}
2 & -x \\
0 & 1
\end{pmatrix}
\]

\paragraph{問3の解答}
%置換行列
(1) と (2) の逆行列は、それぞれ
\[
\begin{pmatrix}
0 & \uline{0} & 1 \\
1 & 0 & \uline{0} \\
0 & 1 & 0
\end{pmatrix}, 
\frac{1}{2}
\begin{pmatrix}
-1 & \uline{1} & 1 \\
1 & -1 & \uline{1} \\
1 & 1 & -1
\end{pmatrix}
\]
である。下線を引いたのが求めるべき成分である。(3) は$\det = 0$なので正則でない。 \qed

\paragraph{問4の解答}
(1), (2) の逆行列はそれぞれ次の通り。下線を引いたのが求めるべき成分である。
\[
\begin{pmatrix}
0 & \uline{1} & 0 & 0 \\
-1 & 0 & 0 & 0 \\
0 & 0 & 0 & \uline{1} \\
0 & 0 & -1 & 0
\end{pmatrix}, 
\frac{1}{3}
\begin{pmatrix}
-2 & \uline{1} & 1 & 1 \\
1 & -2 & 1 & 1 \\
1 & 1 & -2 & \uline{1} \\
1 & 1 & 1 & -2
\end{pmatrix}
\]
\qed

\paragraph{問5の解答}
解は次の通り。

\noindent (1)
\[
x = \frac{a + b}{2}, y = \frac{a - b}{2}
\]
\noindent (2)
\[
x = \frac{b + c}{2}, y = \frac{a + c}{2}, z = \frac{a + b}{2}
\]
\noindent (3)
\[
x = \frac{a - b + c}{2}, y = \frac{a + b - c}{2}, z = \frac{-a + b + c}{2}
\]
\noindent (4)
\[
x = \frac{a + b + c + d}{4}, y = \frac{-a + b - c + d}{4}, z = \frac{-a - b + c + d}{4}, w = \frac{a - b - c + d}{4}
\]
\qed

\paragraph{問6の解答} 解は次の通り。
\[
x = \frac{k + 1}{(k - 1)(k + 2)}, y = \frac{-1}{(k - 1)(k + 2)}, z = \frac{-1}{(k - 1)(k + 2)}
\]
\qed

\paragraph{問7の解答}
係数行列の行列式が$t^2 - 2t$なので、非自明な解が存在するのは$t = 0, 2$の場合である。 \qed

\section{群と群作用}

行列式の性質は前回までに証明してしまったので、今回は行列式絡みで新しく話すことがほとんどありません。そこで「群論」という、少し発展的なことを紹介してみたいと思います。

別に群論のことを知らなくてもこの先の線型代数の勉強で困ることは、たぶんありません。そういう意味では安心してください。ですがこれまでの線型代数の話の中で、実は群論が所々に顔を出していました。群論の基本的な言葉遣いを知っていると、そうした場面の背景を理解することができます。また群論の基本的な言葉を知っていると、知識の整理に役立ちます。この機会に勉強して損はありません。

\subsection{置換の性質と群の公理}

置換のことを少し復習しましょう。$\{1, 2, \ldots, n\}$の置換の全体$\mathfrak{S}_n$を$n$次対称群と呼んでいました。この$n$次対称群は
\begin{itemize}
\item $\sigma, \tau \in \mathfrak{S}_n$の積$\sigma \tau \in \mathfrak{S}_n$が定義されている。
\item $\sigma, \tau, \rho \in \mathfrak{S}_n$に対し、$(\sigma \tau)\rho = \sigma (\tau \rho)$が成り立つ\footnote{あみだくじ$3$つを縦$1$列に並べてつなげるとき、先に上の$2$つをくっつけても、下の$2$つをくっつけても、結果は同じですよね。これだけの話です。この「掛け算の結果が、くっつける順番に依存しない」ことを、\textbf{結合法則}\index{けつごうほうそく@結合法則}といいます。}
\item 恒等置換$\id \in \mathfrak{S}_n$がある
\item 任意の$\sigma \in \mathfrak{S}_n$に対し$\sigma^{-1} \in \mathfrak{S}_n$が存在する
\end{itemize}
という性質を持っていました。

この性質を一般化したものが「群 (group)」と呼ばれるものです。集合$G$が\textbf{群}\index{ぐん@群}であるとは、次の$4$つの条件を満たすことです。
\begin{itemize}
\item 任意の$g, h \in G$に対し積$g \times h \in G$というものが定まる
\item 任意の$g, h, k \in G$に対し$(gh)k = g(hk)$が成り立つ\footnote{ここで$gh := g \times h$です。一々$\times$の記号を書くのがかったるいので、このように略します。}
\item 元$e \in G$であって、全ての$g \in G$に対し$eg = ge = g$を満たすものが存在する
\item 任意の$g \in G$に対し、$g^{-1}$という、$g g^{-1} = g^{-1} g = g$を満たす元が存在する
\end{itemize}
最初に挙げた$\mathfrak{S}_n$の性質をそのまま書き変えたようなものなので、定義からして、$\mathfrak{S}_n$は群になっています。

\paragraph{簡単な群の例} これから「どうして群が大事なのか」という話をしますが、その前に$2$つほど簡単な例を見ておきましょう。話を進めるにしても、例が全くないと辛いと思いますので。

$1$つ目は、$0$でない実数全体の集合$\mathbb{R}^{\times} := \{ x \in \mathbb{R} \mid x \neq 0\}$です。次のようにして、$\mathbb{R}^{\times}$が普通の積を演算とする群になることが言えます。
\begin{itemize}
\item そもそも実数には積が定義されている
\item 実数の積は結合法則を満たす
\item $1 \in \mathbb{R}^{\times}$を他のどの数にかけても、変化しない
\item $\mathbb{R}^{\times}$には$0$が入っていないので、$\mathbb{R}^{\times}$の全ての数は逆数を持つ
\end{itemize}

次に、全ての実数の集合$\mathbb{R}$の上で$+$という演算を考えてみます。この場合
\begin{itemize}
\item 実数には和$+$が定義されている
\item 実数の和は結合法則を満たす
\item $0 \in \mathbb{R}$を他のどの数に足しても、変化しない
\item 任意の数$a \in \mathbb{R}$に対し、$a + (-a) = 0$となる
\end{itemize}
ので、$\mathbb{R}$は和を演算とする群になっています\footnote{「群の定義には『積という演算』という言葉が入っているのに、和でいいのか」と思うかもしれませんが、群の演算を「積」と呼んだり$\times$の記号で表すのは便宜的なものです。積という名前でなくとも、群の公理を満たすような演算が定義されている集合は、群と呼びます。}。

% 加群の話

\subsection{「対称性」とは何か}

それでは、「群」というものを考えるモチベーションを与えましょう。その一つの理由は「対称性」にあります。

\paragraph{対称性と不変性}

皆さんは「対称性」という言葉をよく知っているはずです。身近な図形の中にも様々な対称性があります。たとえば正方形や円は、対称性がある図形の典型的な例ですよね。どちらの図形も、線対称かつ点対称です。
\begin{figure}[h!tbp]
\centering
\begin{picture}(120, 120)
\put(15, 15){\line(1, 0){90}}
\put(15, 15){\line(0, 1){90}}
\put(15, 105){\line(1, 0){90}}
\put(105, 15){\line(0, 1){90}}
\put(60, 60){\circle*{3}}
\put(60, 10){\dashbox(0, 100){}}
\end{picture}
\hfil
\begin{picture}(120, 120)
\put(60, 60){\circle{90}}
\put(60, 60){\circle*{3}}
\put(60, 10){\dashbox(0, 100){}}
\end{picture}
\end{figure}

さて\textbf{図形の対称性とは、ある種の移動に関して不変なこと}に他なりません。たとえば上の正方形がなぜ線対称なのかといえば、点線に関して折り返したときに、元の正方形にぴったり重なるからです。円が線対称な理由も同じですね。また点対称についても「図形が点対称なのは、ある点を中心とする$180^{\circ}$の回転で不変だから」と言うことができます。

他の場合でも事情は全く同じです。「図形が対称性を持つ」というとき、それは「何かの操作をしても図形が変わらないこと」を指しているのです。

\paragraph{$2$つの対称性の関係}

次に「図形の対称性の全体」を考えてみます。先ほどの正方形と円を思い出すと、直感的に
\begin{itemize}
\item どちらの図形も、対称性が高い
\item 正方形と円を比べると、円の方が一段と対称性がある
\end{itemize}
ということは納得できるでしょう。こうした直感をどう定式化するか、それが次の問題です。そのためには
\begin{itemize}
\item 図形を不変にする操作を全て集めてきて
\item それらの操作の間に、どのような関係があるかを調べること
\end{itemize}
が必要です。結論から先に言うと、対称操作の全体がさっきの群の公理を満たし、\textbf{対称性がどれくらいかを群で測れるようになる}のです。

ここで$1$つ重要な事実があります。\textbf{図形を不変にする操作が$2$つあったとき、それを立て続けに行ったものも元の図形を不変にします。}例えば正方形は、折り返しと$90^{\circ}$回転について不変です。したがって正方形を折り返した後に$90^{\circ}$回転をしても、やはり元のままです。
\begin{figure}[h!tbp]
\centering
\hfil
\begin{picture}(120, 120)
\put(15, 15){\line(1, 0){90}}
\put(15, 15){\line(0, 1){90}}
\put(15, 105){\line(1, 0){90}}
\put(105, 15){\line(0, 1){90}}
\put(60, 10){\dashbox(0, 100){}}
\end{picture}
\hfil
\begin{picture}(120, 120)
\put(15, 15){\line(1, 0){90}}
\put(15, 15){\line(0, 1){90}}
\put(15, 105){\line(1, 0){90}}
\put(105, 15){\line(0, 1){90}}
\put(60, 60){\circle*{3}}
\put(-30, 60){\vector(1, 0){30}}
\put(-35, 65){折り返し}
\end{picture}
\hfil
\begin{picture}(120, 120)
\put(15, 15){\line(1, 0){90}}
\put(15, 15){\line(0, 1){90}}
\put(15, 105){\line(1, 0){90}}
\put(105, 15){\line(0, 1){90}}
\put(60, 10){\dashbox(0, 100){}}
\put(-30, 60){\vector(1, 0){30}}
\put(-35, 65){$90^{\circ}$回転}
\end{picture}
\hfil
\end{figure}

そもそも、それぞれの操作が図形を不変に保つのだから、そうした操作を続けて行っても図形が不変なのは当たり前ではあります。でも、この事実は「ある図形を不変に保つ操作全体のなすの集合」を考えるとき、その集合が\textbf{操作の合成で閉じている}という重要な帰結を導きます。これは\textbf{群に積が定義されること}に対応します。

\paragraph{逆写像と恒等写像}

続いて、ある図形を不変に保つ操作があったとき、その逆の操作を考えましょう。たとえば「$90^{\circ}$回転の操作の逆は$-90^{\circ}$回転」といった感じです。「$90^{\circ}$回転して不変に保たれる図形は、$-90^{\circ}$回転しても不変という事実は、明らかでしょう。一般の場合にも「図形がある操作で不変に保たれるなら、その逆の操作でも不変」という事実が成り立ちます。

そして、図形を不変に保つ操作について「合成」ができることをさっき確かめました。図形を不変に保つ操作が与えられたとき、その操作と逆の操作を合成したら「何もしない」操作、つまり恒等写像になります。そこで「図形を不変に保つ操作」を考えるときは、恒等写像も仲間に入れておきましょう。「恒等写像をやっても何も変わらない」というのは当たり前すぎますが、恒等写像は足し算における$0$や掛け算における$1$のような便利な役割を果たしてくれます。

\paragraph{群の公理の見直し}

さあ、これで準備が整いました。もう一度群の公理を見直しましょう。集合$G$が群であるとは
\begin{itemize}
\item 積と呼ばれる演算$\times$が$G$上で定義されている
\item 任意の$g, h, k \in G$に対し$(gh)k = g(hk)$が成り立つ
\item 単位元$e \in G$と呼ばれる、全ての$g \in G$に対して$ge = eg = g$を満たす元が存在する
\item 任意の$g \in G$に対し、$g^{-1}$という、$gg^{-1} = g^{-1}g = g$を満たす元が存在する
\end{itemize}
というものでした。一方、図形$A$を対象に保つ操作全体の集合を$\Aut(A)$と書くと
\begin{itemize}
\item $f, g \in \Aut(A)$に対し、合成$f \circ g \in \Aut(A)$が定義される
\item 任意の$f, g, h \in \Aut(A)$に対し、$(f \circ g) \circ h = f \circ (g \circ h)$が成り立つ
\item 恒等写像$\id$は$\Aut(A)$の元である
\item 任意の$f \in \Aut(A)$に対し、逆の操作$f^{-1} \in \Aut(A)$がある
\end{itemize}
という性質が成り立っています。これは群の公理と全く同じです。「対称性とは何か」を突き詰めていくと、自然に群の考え方にたどり着くのです。

このように「対称性は群である」という理解に到達すると、「$2$つの対称性の比較」ができるようになります。たとえば正方形を不変に保つ操作は、円もまた不変に保ちます。つまり正方形の対称性を表す群は、円の対称性を表す群に完全に含まれるのです。このようにして\textbf{ある図形が別の図形より高い対称性を持つことは、対称性を表す群が大きいこと}として定式化できます。

\subsection{群の色々な例}

「対称性を考えると群が必要になる」ということを確かめたところで、群の例を色々と見ていきましょう。

\paragraph{行列のなす群}

群の中でも、行列がなす群は非常に重要です。登場する場面も幅広く、また図形の対称性を表す群は大体行列のなす群に含まれます。行列の積を使って、色々な群を作りましょう。

% GL, SL, O, SO

まず、$n$次正則行列\index{GLn@$GL_n$}の全体を
\[
GL_n(\mathbb{R}) := \{ A \in \Mat_n(\mathbb{R}) \mid \det A \neq 0 \}
\]
と書きます。このとき
\begin{itemize}
\item $\det AB = \det A \det B$という公式があるから、$A, B \in GL_n(\mathbb{R})$なら$\det AB \neq 0$となり、$AB \in GL_n(\mathbb{R})$が従います。よって行列の積によって、$GL_n(\mathbb{R})$は閉じています。
\item 単位行列$I$はもちろん$GL_n(\mathbb{R})$の元です。
\item 全ての$A \in GL_n(\mathbb{R})$は逆行列$A^{-1} \in GL_n(\mathbb{R})$を持ちます。
\end{itemize}
これで$GL_n(\mathbb{R})$が群になることを示せました。$GL_n(\mathbb{R})$を$n$次\textbf{一般線型群}\index{いっぱんせんけいぐん@一般線型群}\footnote{英語では``\uline{g}eneral \uline{l}inear group''です。この頭文字を取って$GL$と書いています。}といいます。$n = 1$の場合は$GL_1(\mathbb{R}) = \mathbb{R}^{\times}$です。

この$GL_n(\mathbb{R})$の中で、さらに色々な群を作ることができます。次に考えるのは
\[
SL_n(\mathbb{R}) := \{ A \in GL_n(\mathbb{R}) \mid \det A = 1\}\index{SLn@$SL_n$}
\]
というものです。$A, B \in GL_n(\mathbb{R})$が$\det A = \det B = 1$を満たせば$\det AB = \det A^{-1} = 1$なので、積や逆行列を取る操作で$SL_n(\mathbb{R})$は閉じています。よって$SL_n(\mathbb{R})$も群です。これを$n$次\textbf{特殊線型群}\index{とくしゅせんけいぐん@特殊線型群}\footnote{英語では``\uline{s}pecial \uline{l}inear group''です。この頭文字を取って$SL$と書いています。}といいます。

さらに
\begin{align*}
O(n) &:= \{A \in GL_n(\mathbb{R}) | A^{-1} = {}^t\!A \}\index{On@$O(n)$}, \quad
SO(n) := \{A \in O(n) | \det A = 1 \}\index{SOn@$SO(n)$}
\end{align*}
と定めます。このとき
\begin{itemize}
\item $A, B \in O(n)$なら$(AB)^{-1} = B^{-1} A^{-1} = {}^tB {}^t\!A = {}^t(AB)$なので、$AB \in O(n)$
\item 単位行列$I$は$I^{-1} = I = {}^t I$を満たす
\item $A \in O(n)$なら$(A^{-1})^{-1} = A = {}^t({}^t\!A) = {}^t(A^{-1})$である
\end{itemize}
なので、やはり$O(n)$は群です。$SO(n) = O(n) \cap SL_n(\mathbb{R})$なので、$SO(n)$も群です。$O(n)$を$n$次\textbf{直交群}\index{ちょっこうぐん@直交群}、$SO(n)$を$n$次\textbf{特殊直交群}\index{とくしゅちょっこうぐん@特殊直交群}といいます\footnote{名前の由来は``(\uline{s}pecial) \uline{o}rthogonal group''です。}。

\paragraph{回転群}

$n$次直交群$SO(n)$は\textbf{回転群}\index{かいてんぐん@回転群}とも呼ばれます。その中でも最も簡単な$SO(2)$の場合を調べてみましょう。

$SO(2)$の元は$2$次正方行列です。そこで
\[
A = 
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix} \in SO(2)
\]
となるための条件を書き下します。まず$\det A = 1$という条件があるので、$ad - bc = 1$です。これを用いると、$A^{-1} = {}^t\!A$という条件から
\[
\begin{pmatrix}
d & -b \\
-c & a
\end{pmatrix}
=
\begin{pmatrix}
a & c \\
b & d
\end{pmatrix}
\]
が導かれます。よって$a = d, b = -c$です。これを$A$の式に代入して、再び$\det$を計算すると
\[
1 = \det A =
\det
\begin{pmatrix}
a & -c \\
c & a
\end{pmatrix}
= a^2 + c^2
\]
となるので、$a = \cos \theta, c = \sin \theta$と書けます。つまり$A \in SO(2)$の元は、回転行列の形に書けます。逆に、どんな回転行列
\[
R(\theta) = 
\begin{pmatrix}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta
\end{pmatrix}
\]
に対しても$\det R(\theta) = 1$と${}^t R(\theta) = R(-\theta) = R(\theta)^{-1}$が従います。これで$SO(2)$は、回転行列全体のなす集合と一致することが分かりました。これが回転群と呼ばれる所以です。$3$次以上でも同様で、$SO(n)$は$n$次元空間$\mathbb{R}^n$における原点周りの回転操作の全体に他なりません。

\subsection{群作用}

群が「図形の対称性」として現れることを説明する際、群のそれぞれの元は「ある図形を不変に保つ操作」を表すことを見ました。このように、群が「何かの操作」を表すことは良くあります。

典型的な例は一般線型群$GL_n(\mathbb{R})$です。$A \in GL_n(\mathbb{R})$は$n$次正方行列ですから、$n$次元の数ベクトル$\bm{u} \in \mathbb{R}^n$に対して$A\bm{u}$を定義することができます。こういう状況を指して、$GL_n(\mathbb{R})$は$\mathbb{R}^n$に\textbf{作用する}\index{さよう@(群の) 作用}といいます。

一般の定義も大体同じです。群$G$と集合$X$について
\begin{itemize}
\item $g \in G$と$x \in X$に対して$g\cdot x \in X$という元が定まっていて
\item 任意の$g, h \in G$と任意の$x \in X$に対し、$g(hx) = (gh)x$が成り立つ\footnote{一々中点を打つのが面倒なので、$g\cdot x$のことを$gx$と略しています。}
\end{itemize}
とき、\textbf{群$G$は集合$X$に作用する}といいます。

作用には$g(hx) = (gh)x$という条件がついていますが、さっきの$GL_n(\mathbb{R})$と$\mathbb{R}^n$の例なら、$A (B\bm{v}) = (AB) \bm{v}$と言っているだけです。群には積が定義されているので、$g$と$h$を続けて$x$に作用させたものと$gh$を$x$に作用させたものが無関係だと、「群」が作用する意味がありません。この事情は「線型空間の間の写像を考えるときは、線型写像を考えることが自然」という話と似ています。図式にすると、次の四角を左上から右下に行くとき、どちら向きで回っても結果が同じということです。
\[
\begin{tikzcd}
(g, h, x) \arrow[mapsto]{r}{\text{積}}  \arrow[mapsto]{d}{\text{作用}} & (gh, x) \arrow[mapsto]{d}{\text{作用}} \\
(g, hx) \arrow[mapsto]{r}{\text{積}} & g(hx) = (gh) x
\end{tikzcd}
\]

\paragraph{対称群の多項式環への作用}

実は既に一度、群の作用が出てきています。それは対称群の多項式への作用です。$n$変数の多項式$f(x_1, x_2, \ldots, x_n) \in \mathbb{R}[x_1, x_2, \ldots, x_n]$と$n$次対称群の元$\sigma \in \mathfrak{S}_n$に対し
\[
(\sigma f)(x_1, x_2, \ldots, x_n) := f(x_{\sigma^{-1}(1)}, x_{\sigma^{-1}(2)}, \ldots, x_{\sigma^{-1}(n)})
\]
と定めます。たとえば$f(x_1, x_2, x_3) := x_1^3 + x_2^2 + x_3$のとき
\begin{align*}
\bigl((1 \ 2) f\bigr)(x_1, x_2, x_3) &= f(x_2, x_1, x_3) = x_2^3 + x_1^2 + x_3, \quad
(1 \ 2 \ 3) f(x_1, x_2, x_3) &= f(x_3, x_1, x_2) = x_2^3 + x_3^2 + x_1
\end{align*}
という感じです。$f$を函数だと思った時、$i$番目の引数を$\sigma(i)$番目に移動させています。$x_i$を$x_{\sigma(i)}$に移すのではないことに気を付けてください。このとき
\begin{align*}
\bigl((\sigma \tau) f\bigr)(x_1, x_2, \ldots, x_n)
&= f(x_{(\sigma\tau)^{-1}(1)}, x_{(\sigma\tau)^{-1}(2)}, \ldots, x_{(\sigma\tau)^{-1}(n)}) \\
\bigl(\sigma (\tau f)\bigr)(x_1, x_2, \ldots, x_n)
&= (\tau f)(x_{\sigma^{-1}(1)}, x_{\sigma^{-1}(2)}, \ldots, x_{\sigma^{-1}(n)})
= f(x_{\sigma^{-1} \circ \tau^{-1}(1)}, x_{\sigma^{-1} \circ \tau^{-1}(2)}, \ldots, x_{\sigma^{-1} \circ \tau^{-1}(n)}) \\
&= f(x_{(\tau \circ \sigma)^{-1}(1)}, x_{(\tau \circ \sigma)^{-1}(2)}, \ldots, x_{(\tau \circ \sigma)^{-1}(n)})
= f(x_{(\sigma \tau)^{-1}(1)}, x_{(\sigma \tau)^{-1}(2)}, \ldots, x_{(\sigma \tau)^{-1}(n)})
\end{align*}
となるので、確かに$\mathfrak{S}_n$は$n$変数多項式全体の集合$\mathbb{R}[x_1, x_2, \ldots, x_n]$に対して作用しています。

この作用の下で、全ての$\sigma \in \mathfrak{S}_n$で不変な多項式とは、$n$変数の対称多項式に他なりません。したがって$\mathbb{R}[x_1, x_2, \ldots, x_n]^{\mathfrak{S}_n}$は対称多項式全体の集合を表します。

%\paragraph{多項式環への$2$通りの作用}

%ちなみに今の計算の中で$\sigma\tau(i) = \tau \circ \sigma(i)$という式を使っています。置換の積を$\sigma\tau = \tau \circ \sigma$にする流儀を採用したおかげで、きちんと作用が定まっているのです。%もう一つの流儀$\sigma\tau = \sigma \circ \tau$を採用すると、$\mathfrak{S}_n$の作用を
%\[
%\sigma f(x_1, x_2, \ldots, x_n) := f(x_{\sigma^{-1}(1)}, x_{\sigma^{-1}(2)}, \ldots, x_{\sigma^{-1}(n)})
%\]
%という式で定義しなければいけません。ここに$\sigma^{-1}$が出てきてちょっと面倒になります。置換の積の流儀をどうするかという問題は、例えばこのような「写像の合成と同じ向きにするか、作用の定義式を見やすくするか」というトレードオフの形で現れるのです。

\paragraph{群作用と不変性}

最後に、群作用に対する不変性の話をしましょう。群$G$が集合$X$に作用しているとします。
\begin{itemize}
\item $G$の作用で動かない$X$の元全体を$X^G := \{x \in X \mid gx = g \ (\forall g \in G)\}$と書きます。
\item $X$の部分集合$A$と$g \in G$に対し$gA := \{gx \mid x \in A\}$と定めます。$A \subset gA$が任意の$g \in G$について成り立つとき、$A$は\textbf{$G$作用で不変}であるといいます。
%\item $x \in X$に対し、$x$を$G$の元で動かして得られる元全ての集合を$Gx := \{gx \in X \mid g \in G\}$と書きます。これを$x$の\textbf{$G$軌道}といいます。
\end{itemize}

典型的な例は、もちろん対称な図形です。たとえば平面$\mathbb{R}^2$内の単位円周$S^1 := \{(x, y) \in \mathbb{R}^2 \mid x^2 + y^2 = 1\}$上の点を回転行列でどう回しても、また$S^1$上の点になります。よって$S^1$は$SO(2)$不変な図形です。また$x$軸、$y$軸に関する折り返しと原点中心の$180$度回転を集めて
\[
G := \biggl\{
\begin{pmatrix}
1 & 0 \\
0 & 1
\end{pmatrix}, 
\begin{pmatrix}
-1 & 0 \\
0 & 1
\end{pmatrix}, 
\begin{pmatrix}
1 & 0 \\
0 & -1
\end{pmatrix}, 
\begin{pmatrix}
-1 & 0 \\
0 & -1
\end{pmatrix}
\biggr\}
\]
と定めると、これは群になります。たとえば平面$\mathbb{R}^2$の$4$点$(\pm1, \pm1)$を頂点とする正方形の周を$S$とすると、この群$G$で不変な図形です。ただ正方形$S$は$90$度回転でも不変なので、$S$を不変に保つ線型変換の全体のなす群は、$G$より大きい群になります。また別の機会に紹介しますが、そういう正$n$角形を不変に保つような変換全体のなす群を\textbf{二面体群}\index{にめんたいぐん@二面体群}といいます。

\subsection{準同型写像}

さて、線型空間の間の写像を考えるにあたって、僕たちは線型写像という特別な写像を定義しました。これは線型空間における和やスカラー倍といった操作に対して整合的になるよう、写像に条件を課したものです。

このアナロジーで考えると、群の間の写像を考える際には、群の積と整合的な写像を考えるべきだと思われます。つまり$G, H$が群で$x, y \in G$のとき、写像$f\colon G \rightarrow H$が$f(xy) = f(x)f(y)$を満たしてくれたら嬉しいというわけです。このような条件を満たす写像を群の\textbf{準同型写像}\index{じゅんどうけい@(群の) 順同型写像}といいます。場合によっては「写像」を略し、単に準同型と呼ぶこともあります。

既に今まで見た例の中にも、いくつか群準同型が現れています。確認してみましょう。

\paragraph{例1: 行列式}

$n$を自然数とします。行列式は全ての$n$次正方行列に対して定義されますが、それを正則行列に制限すると、値域は$0$以外の実数全体の集合$\mathbb{R}^{\times}$になります。したがって$\det \colon GL_n(\mathbb{R}) \rightarrow \mathbb{R}^{\times}$という写像が得られます。ここで$\det$の乗法性から、$A, B \in GL_n(\mathbb{R})$に対して$\det AB = \det A \det B$が成り立ちます。よって$\det$は、群$GL_n(\mathbb{R})$から群$\mathbb{R}^{\times}$への準同型写像です。

\paragraph{例2: 置換の符号}

$n$次対称群$\mathfrak{S}_n$の符号$\sgn$は、置換に対して$\pm1$のいずれかを対応させる写像でした。したがって$\sgn \colon \mathfrak{S}_n \rightarrow \{\pm1\}$です。この$\{\pm1\}$は、普通の数の掛け算で群になっています。そして任意の$\sigma, \tau \in \mathfrak{S}_n$に対し$\sgn(\sigma \tau) = \sgn(\sigma) \sgn(\tau)$が成り立つのでした。よって$\sgn$は群準同型です。

\subsection{同型写像}

群$G, H$と群準同型$f\colon G\rightarrow H$が与えられたとします。$f$が全単射であるとき、$f$のことを特に\textbf{同型写像}\index{どうけいしゃぞう@(群の) 同型写像}といいます。略して単に同型と呼ぶこともあります。また群$G$と群$H$の間に同型写像があることを、$G \simeq H$と書きます。

同型がありがたいのは、これによって群の\textbf{同一視}ができるということです。例を見てみましょう。

\paragraph{$U(1)$と$SO(2)$} 絶対値$1$の複素数全体のなす集合を$U(1) := \{ z \in \mathbb{C} \mid |z| = 1 \} $と書きます\footnote{一般に$1$以上の整数$n$に対し、$n$次ユニタリ群$U(n)$と呼ばれるものが定義されるのに合わせ、こんな記号を使っています。}。このとき$z \in U(1)$は極形式で$z = e^{i\theta} = \cos\theta + i \sin\theta$と書けます。そこで
\[
U(1) \ni \cos\theta + i \sin\theta \mapsto
\begin{pmatrix}
\cos\theta & -\sin\theta \\
\sin\theta & \cos\theta
\end{pmatrix}
\in SO(2)
\]
という対応で写像$f \colon U(1) \rightarrow SO(2)$を作ります。すると加法定理から
\begin{align*}
&(\cos\theta + i \sin\theta)(\cos\varphi + i \sin\varphi)
= \cos(\theta + \varphi) + i \sin(\theta + \varphi) \\
&\begin{pmatrix}
\cos\theta & -\sin\theta \\
\sin\theta & \cos\theta
\end{pmatrix}
\begin{pmatrix}
\cos\varphi & -\sin\varphi \\
\sin\varphi & \cos\varphi
\end{pmatrix}
=
\begin{pmatrix}
\cos(\theta + \varphi) & -\sin(\theta + \varphi) \\
\sin(\theta + \varphi) & \cos(\theta + \varphi)
\end{pmatrix}
\end{align*}
が成り立つので、$f(e^{i\theta}) f(e^{i\varphi}) = f(e^{i(\theta + \varphi)}) = f(e^{i\theta} e^{i\varphi})$となっています。つまり$f$は群準同型です。そして
\[
SO(2) \ni
\begin{pmatrix}
\cos\theta & -\sin\theta \\
\sin\theta & \cos\theta
\end{pmatrix}
\mapsto
\cos\theta + i \sin\theta
\in U(1)
\]
という対応が明らかに$f$の逆写像を与えるので、$f$は全単射です。つまり$f$は群の同型写像で、$U(1) \simeq SO(2)$です。

この事実自体は、今になって取り立てて説明するほどのことではありません。平面で点を原点周りに回転させるのに、複素数を使っても回転行列を使っても良いというだけの話です。ですがここで大事なのは、今まで「結局やってることは同じだよね」って感覚では理解していたことを「群として$U(1)$と$SO(2)$で同型がある」という言葉によって定式化できたという点です。

\paragraph{置換行列}

$n$次対称群の元$\sigma \in \mathfrak{S}_n$に対し、行列$P(\sigma)$を
\begin{align*}
P(\sigma)_{ij} :=
\begin{cases}
1 & \bigl(j = \sigma(i)\bigr) \\
0 & \bigl(j \neq \sigma(i)\bigr)
\end{cases}
\end{align*}
で定めます。たとえば$n = 3$なら
\[
P\bigl((12)\bigr)
=
\begin{pmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1
\end{pmatrix}, 
P\bigl((23)\bigr)
=
\begin{pmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{pmatrix}, 
P\bigl((132)\bigr)
=
\begin{pmatrix}
0 & 0 & 1 \\
1 & 0 & 0 \\
0 & 1 & 0
\end{pmatrix}
\]
という感じです。要は$n$次元のベクトルに当てたとき、$i$番目の成分$\bm{e}_i$を$\sigma^{-1}(i)$番目にうつすのが$P(\sigma)$です。このとき
\begin{align*}
\bigl(P(\sigma) P(\tau)\bigr)_{ij}
= \sum_{k = 1}^n P(\sigma)_{ik} P(\tau)_{kj}
= P(\sigma)_{i \sigma(i)}P(\tau)_{\sigma(i)j}
=
\begin{cases}
1 & \bigl(j = \tau(\sigma(i))\bigr) \\
0 & \bigl(j \neq \tau(\sigma(i))\bigr)
\end{cases}
\end{align*}
なので、$\sigma \tau = \tau \circ \sigma$を思い出すと$P(\sigma)P(\tau) = P(\sigma\tau)$となっています。よって$P\colon \mathfrak{S}_n \rightarrow GL_n(\mathbb{R})$は群の準同型です。この$P(\sigma)$のことを、$\sigma$に対応する\textbf{置換行列}\index{ちかんぎょうれつ@置換行列}といったりします。$n$次の置換行列は$n!$個あり、これは$\mathfrak{S}_n$の個数と同じです。そして異なる置換に対応する置換行列は異なります。よって$P$は$\mathfrak{S}_n$と置換行列全体との集合の間の全単射を与え、$n$次の置換行列全体のなす群は$\mathfrak{S}_n$と同型になります。

\paragraph{正三角形の対称性}

今の置換行列を応用すると「正三角形の対称性」を完全に決定することができます。

正三角形は平面図形ですが、後々の都合上、$3$次元空間$\mathbb{R}^3$の$3$つの点$P_1(1, 0, 0)$, $P_2(0 ,1, 0)$, $P_3(0, 0, 1)$を頂点にして正三角形$T$を作ります。このとき正三角形$T$を不変に保つ線型変換は、正三角形$T$の頂点を頂点に移すので$P_1, P_2, P_3$を入れ替えます。つまり$\bm{e}_1, \bm{e}_2, \bm{e}_3$をこの中で入れ替えます。一方$\mathbb{R}^3$の線型変換は$\bm{e}_1, \bm{e}_2, \bm{e}_3$の行き先で完全に決まるのでした。これより正三角形$T$を不変にする線型変換は、$\mathfrak{S}_3$に対応する置換行列
\[
\begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{pmatrix}, 
\begin{pmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1
\end{pmatrix}, 
\begin{pmatrix}
1 & 0 & 0 \\
0 & 0 & 1 \\
0 & 1 & 0
\end{pmatrix}, 
\begin{pmatrix}
0 & 1 & 0 \\
0 & 0 & 1 \\
1 & 0 & 0
\end{pmatrix}, 
\begin{pmatrix}
0 & 0 & 1 \\
1 & 0 & 0 \\
0 & 1 & 0
\end{pmatrix}, 
\begin{pmatrix}
0 & 0 & 1 \\
0 & 1 & 0 \\
1 & 0 & 0
\end{pmatrix}
\]
のいずれかしかないことが分かります。

逆に、上に挙げた$6$個の置換行列は全て正三角形$T$を不変に保つことが直接確かめられます。たとえば
\[
P\bigl((12)\bigr) = 
\begin{pmatrix}
0 & 1 & 0 \\
1 & 0 & 0 \\
0 & 0 & 1
\end{pmatrix}
\]
は$\bm{e}_1$と$\bm{e}_2$を入れ替えて$\bm{e}_3$をそのまま保つので、正三角形$T$上で見れば、頂点$P_3$を通る軸に関する線対称移動になっています。同様に$P\bigl((13)\bigr)$, $P\bigl((23)\bigr)$はいずれも線対称移動です。また$P\bigl((123)\bigr)$や$P\bigl((132)\bigr)$は$\bm{e}_1, \bm{e}_2, \bm{e}_3$を順繰りに入れ替えるので、$120^{\circ}$ないし$240^{\circ}$の回転移動を表します。そして単位行列はもちろん、恒等変換に対応しています。こうして正三角形$T$を不変に保つ線型変換の集合は、$3$次の置換行列全体と一致することが分かりました。

そして重要なのは、$\mathfrak{S}_3$の元同士を掛け算したらどうなるかを一覧にした次の表です。$\sigma$に対応する行と$\tau$に対応する列に、$\sigma\tau$を書いています。
\begin{table}[h!tbp]
\centering
\caption{$\mathfrak{S}_3$の乗積表}
\begin{tabular}{c|cccccc} \hline
		&	$\id$	&	$(12)$	&	$(23)$	&	$(13)$	&	$(123)$	&	$(132)$ \\ \hline
$\id$	&	$\id$	&	$(12)$	&	$(23)$	&	$(13)$	&	$(123)$	&	$(132)$ \\
$(12)$	&	$(12)$	&	$\id$	&	$(132)$	&	$(123)$	&	$(13)$	&	$(23)$ \\
$(23)$	&	$(23)$	&	$(123)$	&	$\id$	&	$(132)$	&	$(12)$	&	$(13)$ \\
$(13)$	&	$(13)$	&	$(132)$	&	$(123)$	&	$\id$	&	$(23)$	&	$(12)$ \\
$(123)$	&	$(123)$	&	$(23)$	&	$(13)$	&	$(12)$	&	$(132)$	&	$\id$ \\
$(132)$	&	$(132)$	&	$(13)$	&	$(12)$	&	$(23)$	&	$\id$	&	$(123)$ \\ \hline
\end{tabular}
\end{table}

$P\colon \mathfrak{S}_3 \rightarrow GL_3(\mathbb{R})$が群準同型だから、この表は置換行列の積の結果をも表しています。つまり回転操作や線対称移動といった正三角形を不変に保つ線型変換たちについて、合成した結果がどういう線型変換になるかが全て書かれているのです。置換行列のなす群は$\mathfrak{S}_3$と同型だから、僕たちは「正三角形の対称性を特徴づける群は$\mathfrak{S}_3$である」と言うことができます。

\subsection{まとめ}

ここまでの話をまとめましょう。
\begin{itemize}
\item 群は「図形の対称性」を定式化するのに必要な概念である
\item 線型代数をしていると、群や群作用が身近なところに現れる
\end{itemize}
ということを説明し、その例を紹介しました。少しでも群が身近に感じてもらえたらと思うのですが、いかがでしょうか。この後の線型代数の授業でも、裏方に群が現れる場面がたくさん登場するはずですので、その都度背景を紹介していく予定です。興味のある方は、自分でも群論の簡単な教科書を読むなどしてみてください。

